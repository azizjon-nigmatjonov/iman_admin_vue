(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ed6ac5ae"],{2909:function(e,t,s){"use strict";s.d(t,"a",(function(){return c}));var n=s("6b75");function i(e){if(Array.isArray(e))return Object(n["a"])(e)}s("a4d3"),s("e01a"),s("d3b7"),s("d28b"),s("3ca3"),s("ddb0"),s("a630");function r(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}var a=s("06c5");function o(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(e){return i(e)||r(e)||Object(a["a"])(e)||o()}},bbf6:function(e,t,s){},d748:function(e,t,s){"use strict";s.r(t);var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("a-card",{staticClass:"mb-2",attrs:{size:"small"}},[s("a-row",{attrs:{justify:"space-between",align:"middle",type:"flex"}},[s("a-col",{attrs:{span:"auto"}},[s("a-breadcrumb",[s("a-breadcrumb-item",{attrs:{href:""}},[s("a-icon",{attrs:{type:"home"}})],1),s("a-breadcrumb-item",[s("a",{on:{click:function(t){return e.$router.go(-1)}}},[s("a-icon",{attrs:{type:"user"}}),s("span",[e._v("Роли")])],1)]),s("a-breadcrumb-item",[e._v(" Назначение роли пользователя ")])],1)],1),s("a-col",{attrs:{span:"auto"}},[s("a-button",{staticStyle:{color:"white",background:"#4CAF50",border:"none"},attrs:{loading:e.loadingBtn},on:{click:e.savePermissions}},[e._v("Сохранить изменения")])],1)],1)],1),s("a-row",{attrs:{gutter:[8]}},[s("a-col",{attrs:{span:7}},[s("a-card",{staticStyle:{height:"auto"}},[s("a-input",{staticClass:"mb-2",staticStyle:{padding:"14px"},attrs:{spellcheck:"false",placeholder:"Поиск ролей"},on:{change:e.search}}),e._l(e.permissions,(function(t){return s("div",{key:t.id,class:t.disabled?"card_left back_color":"card_left"},[s("a-row",{attrs:{type:"flex",justify:"space-between",align:"middle"}},[s("a-col",{attrs:{span:"auto"}},[s("span",{staticClass:"mx-1"},[e._v(e._s(t.name))])]),s("a-col",{attrs:{span:"auto"}},[s("a-button",{attrs:{disabled:t.disabled,type:"border"},on:{click:function(s){return e.addToUserPermission(t)}}},[e._v("Add")])],1)],1)],1)}))],2)],1),s("a-col",{attrs:{span:"17"}},[s("a-card",{staticStyle:{width:"100%"}},[s("a-table",{attrs:{bordered:"",columns:e.columns,"data-source":e.userPermissions},scopedSlots:e._u([{key:"actions",fn:function(t){return s("span",{},e._l(t.actions,(function(t){return s("a-checkbox",{key:t.id,attrs:{disabled:"",defaultChecked:!0}},[e._v(" "+e._s(t.name)+" ")])})),1)}},{key:"action",fn:function(t,n){return s("span",{},[s("a-row",{attrs:{type:"flex",gutter:[16]}},[s("a-col",{attrs:{span:"auto"}},[s("a-tooltip",{attrs:{placement:"bottomLeft",title:e.$t("button.delete")}},[s("a",{on:{click:function(t){return e.removePerminant(n)}}},[e._v(e._s(e.$t("button.delete")))])])],1)],1)],1)}}])})],1)],1)],1)],1)},i=[],r=s("5530"),a=s("2909"),o=(s("498a"),s("4de4"),s("d3b7"),s("caad"),s("2532"),s("b0c0"),s("d81d"),s("07ac"),s("a434"),s("c740"),s("159b"),{data:function(){return{loadingBtn:!1,permissions:[],csp:!0,user_role_id:"",cachedData:[],userPermissions:[],columns:[{title:"Название",key:"permission_name",dataIndex:"permission_name"},{title:"Список разрешений",key:"actions",scopedSlots:{customRender:"actions"}},{title:this.$t("table.actions"),key:"action",scopedSlots:{customRender:"action"}}]}},methods:{search:function(e){var t=Object(a["a"])(this.permissions);e.target.value.trim().length>0?this.permissions=t.filter((function(t){return t.name.toLocaleLowerCase().includes(e.target.value.toLocaleLowerCase())})):this.getPermissions()},getPermissions:function(){var e=this;this.$store.dispatch("getPermissions").then((function(t){e.permissions=t,e.$store.dispatch("getUserRolePermissions",e.user_role_id).then((function(s){e.setUserRolePermissions(s),e.permissions=t.map((function(e){return Object(r["a"])(Object(r["a"])({},e),{},{disabled:s.permissions.filter((function(t){return e.id===t.id})).length>0})}))}))}))},setUserRolePermissions:function(e){this.userPermissions=e.permissions.map((function(e){return{actions:e.actions,create:!!e.actions.filter((function(e){return"create"===e.key})).length,read:!!e.actions.filter((function(e){return"read"===e.key})).length,update:!!e.actions.filter((function(e){return"update"===e.key})).length,delete:!!e.actions.filter((function(e){return"delete"===e.key})).length,permission_id:e.id,permission_name:e.name,key:e.id,id:e.id}}))},savePermissions:function(){var e=this;this.loadingBtn=!0;var t=this.userPermissions.map((function(e){var t={create:e.create?e.actions.filter((function(e){return"create"===e.key})):[],read:e.read?e.actions.filter((function(e){return"read"===e.key})):[],update:e.update?e.actions.filter((function(e){return"update"===e.key})):[],delete:e.delete?e.actions.filter((function(e){return"delete"===e.key})):[]};return{action_ids:Object.values(t).map((function(e){return!!e.length&&e[0].id})).filter(Boolean),id:e.permission_id}}));this.$store.dispatch("postUserRolePermission",{permissions:Object(a["a"])(t),user_role_id:this.user_role_id}).then((function(t){e.$alertMessage("success","SAVED","User Role Permission saved successfully",e)})).finally((function(){return e.loadingBtn=!1}))},addToUserPermission:function(e){e.disabled=!0,this.userPermissions.push({create:!0,read:!0,update:!0,delete:!0,permission_id:e.id,permission_name:e.name,actions:e.actions.map((function(e){return Object(r["a"])(Object(r["a"])({},e),{},{value:!0})})),key:e.id,id:""})},getUserRolePermissions:function(){var e=this;this.$store.dispatch("getUserRolePermissions",this.user_role_id).then((function(t){e.setUserRolePermissions(t)}))},removePerminant:function(e){this.userPermissions.splice(this.userPermissions.findIndex((function(t){return t.key===e.key})),1),this.permissions.forEach((function(t){t.id===e.key&&(t.disabled=!1)}))}},created:function(){this.user_role_id=this.$route.params.id,this.getPermissions()}}),c=o,u=(s("db39"),s("2877")),d=Object(u["a"])(c,n,i,!1,null,"7c12e515",null);t["default"]=d.exports},db39:function(e,t,s){"use strict";s("bbf6")}}]);