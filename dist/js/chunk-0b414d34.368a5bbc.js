(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0b414d34"],{"15fd":function(t,e,a){"use strict";a.d(e,"a",(function(){return r}));a("a4d3"),a("b64b");function s(t,e){if(null==t)return{};var a,s,r={},n=Object.keys(t);for(s=0;s<n.length;s++)a=n[s],e.indexOf(a)>=0||(r[a]=t[a]);return r}function r(t,e){if(null==t)return{};var a,r,n=s(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)a=i[r],e.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(t,a)&&(n[a]=t[a])}return n}},"2a75":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-navigation",{attrs:{list:[{name:t.$t("Продажа")}],isBack:{flag:!1,link:"/sale"},noBorder:""}},[a("a-button",{staticStyle:{float:"right"},attrs:{type:"primary",icon:"file-excel"},on:{click:t.download}},[t._v(t._s(t.$t("Export to excel")))])],1),a("a-card",{staticClass:"no-space-tab"},[a("a-card",[a("div",{staticClass:"mb-3"},[a("a-form-model",{ref:"ruleForm",attrs:{colon:!1,layout:"horizontal",rules:t.rules,model:t.form}},[a("a-row",{attrs:{type:"flex",justify:"space-between",gutter:[16,16]}},[a("a-col",{attrs:{md:6}},[a("a-form-model-item",[a("div",{staticStyle:{display:"flex","align-items":"center"}},[a("span",{staticStyle:{"margin-right":"10px"}},[t._v(t._s(t.$t("search"))+":")]),a("a-input",{attrs:{placeholder:t.$t("search")},on:{change:t.filterInput},model:{value:t.searcher.search,callback:function(e){t.$set(t.searcher,"search",e)},expression:"searcher.search"}})],1)])],1),a("a-col",{attrs:{md:6}},[a("a-form-model-item",{attrs:{prop:"date"}},[a("a-range-picker",{staticStyle:{width:"100%"},attrs:{format:"YYYY-MM-DD","show-time":{hideDisabledOptions:!1}},on:{change:t.filterInput3},model:{value:t.form.date,callback:function(e){t.$set(t.form,"date",e)},expression:"form.date"}})],1)],1)],1)],1)],1),a("a-table",{attrs:{columns:t.columns,"data-source":t.installment_list,"row-key":function(t){return t.guid},pagination:t.pagination,loading:t.spinning,scroll:{x:"auto"},bordered:"",rowClassName:function(t){return t.verified?"table-row-green":""}},on:{change:t.getPagination},scopedSlots:t._u([{key:"customer.birthday",fn:function(e){return a("span",{},[t._v(" "+t._s(t._f("moment")(e.customer.birthday,t.$dateFormat))+" ")])}},{key:"created_at",fn:function(e){return a("span",{},[t._v(" "+t._s(t._f("moment")(e.created_at,t.$dateTimeFormat))+" ")])}},{key:"pos_agent",fn:function(e){return a("span",{},[t._v(" "+t._s(e.pos_agent.first_name+" "+e.pos_agent.last_name)+" "),a("br"),t._v(" "+t._s(e.pos_agent.phone_number)+" ")])}},{key:"merchant_branch",fn:function(e){return a("span",{},[t._v(" "+t._s(e.merchant.merchant.name+" /  "+e.merchant.merchant_branch.name)+" ")])}},{key:"first_payment_day",fn:function(e){return a("span",{},[t._v(" "+t._s(e.first_payment_day?t.formatDate(e.first_payment_day):"")+" ")])}},{key:"contract_number",fn:function(e){return a("span",{},[t._v(" "+t._s(e.contract_number.slice(3))+" ")])}},{key:"amount_per_month",fn:function(e){return a("span",{},[t._v(" "+t._s(t.$moneyFormat(e.amount_per_month))+" ")])}},{key:"installment_amount",fn:function(e){return a("span",{},[t._v(" "+t._s(t.$moneyFormat(e.installment_amount))+" ")])}},{key:"status",fn:function(e){return a("span",{},[a("a-tag",{attrs:{color:t.getStatusColor(e.status)}},[t._v(t._s(e.status))])],1)}},{key:"actions",fn:function(e){return a("span",{},[a("a-tooltip",{attrs:{placement:"bottomLeft",title:t.$t("button.preview")}},[a("a-button",{staticClass:"mx-1",attrs:{type:"primary",icon:"edit"},on:{click:function(a){return t.$router.push({name:"edit scroing",params:{id:e.guid}})}}})],1)],1)}}])})],1)],1)],1)},r=[],n=a("15fd"),i=a("5530"),o=(a("ac1f"),a("1276"),a("841c"),a("5319"),a("d3b7"),a("b047")),u=a.n(o),c=a("c1df"),l=a.n(c),h=["status"],d=["status"],m={data:function(){return this.filterInput=u()(this.filterInput,700),{currentTab:"3аявки",typeList:["Все","3аявки","Приход","Продажа","Успешный"],status:this.$route.path.split("/")[1],spinning:!1,vis:!1,visible:{flag:!1,data:{customer:{}}},pagination:{current:1,showQuickJumper:!0},installment_list:[],searcher:{search:""},form:{date:[]},date_begin:"",date_end:"",rules:{date:[{required:!0,message:"Пожалуйста, введите дату",trigger:"blur"}]},customersList:[],customer:"customers",statusList:[],selectedStatus:"status",columns:[{title:this.$t("contract_number"),dataIndex:"contract_number",key:"contract_number",customCell:this.onRowCLickFunc},{title:this.$t("Сумма (Общее с рассрочкой)"),dataIndex:"installment_amount",key:"total_price",customCell:this.onRowCLickFunc},{title:this.$t("Created_at"),scopedSlots:{customRender:"created_at"},key:"created_at",customCell:this.onRowCLickFunc},{title:this.$t("bonds.table.status"),scopedSlots:{customRender:"status"},key:"status",width:160,customCell:this.onRowCLickFunc}]}},watch:{"$route.query":{handler:function(){var t=null;this.$isEmptyObj(this.$route.query)?t={limit:10,page:1}:(t=this.$route.query,t.start_date&&(this.form.date=[l()(t.start_date),l()(t.end_date)]),this.pagination.current=parseInt(this.$route.query.page),this.searcher.search=this.$route.query.query);var e={contract_number:t.query,limit:10,offset:t.page?t.page-1:0,customer_id:"customers"===this.customer?"":this.customer,start_date:t.start_date,end_date:t.end_date,status:"sale"===this.status?"":this.status};this.getInstallmentListSale(e)}}},methods:{onRowCLickFunc:function(t,e){var a=this;return{on:{click:function(e){a.$router.push({name:"edit scoring sale",params:{id:t.guid}})}}}},formatDate:function(t){return l()(t).format("DD.MM.YYYY")},onTabChange:function(t){this.currentTab=t},filterInput:function(t){var e=Object(i["a"])({},this.$route.query);e.query=this.searcher.search,e.page=1,e.status="done",this.form.date.length&&(e.start_date=this.form.date[0].format("YYYY-MM-DD"),e.end_date=this.form.date[1].format("YYYY-MM-DD"));e.status;var a=Object(n["a"])(e,h);this.$router.push({path:this.$router.fullPath,query:Object(i["a"])(Object(i["a"])({},a),{},{page:1})})},filterInput3:function(t){var e=Object(i["a"])({},this.$route.query);if(e=t&&t.length?{start_date:t[0].format("YYYY-MM-DD"),end_date:t[1].format("YYYY-MM-DD")}:{start_date:void 0,end_date:void 0},"customers"!==this.customer&&(e.customerId=this.customer),"sale"!==this.status&&(e.status=this.status),this.searcher.search){e.query=this.searcher.search;var a=e,s=(a.status,Object(n["a"])(a,d));this.$router.push({path:this.$router.fullPath,query:Object(i["a"])(Object(i["a"])(Object(i["a"])({},this.$route.query),s),{},{page:1})})}else this.$router.replace({query:e})},download:function(t){var e=this;t.preventDefault(),this.$refs.ruleForm.validate((function(t,a){if(t){e.date_begin=e.form.date[0].format("YYYY-MM-DD"),e.date_end=e.form.date[1].format("YYYY-MM-DD");var s={start:e.date_begin,end:e.date_end,status:"done"};e.$store.dispatch("getInstallmentReports",s).then((function(t){var e=t.filename,a=document.createElement("a");a.href=e,a.setAttribute("download","File"),document.body.appendChild(a),a.click()})).catch((function(t){e.$alertMessage(t.response.data.message)}))}}))},getStatusColor:function(t){var e;switch(t){case"closed":e="cyan";break;case"done":e="green";break;case"reject":e="red";break;case"new":e="green";break;case"pending":e="orange";break;case"passed":e="#87d068";break;case"not-passed":e="red";break;default:e=""}return e},getPagination:function(t){this.searcher.search?(this.$router.push({path:this.$router.fullPath,query:Object(i["a"])(Object(i["a"])({},this.$route.query),{},{page:t.current,limit:10,query:this.searcher.search})}),this.pagination.current=t.current):(this.$router.push({path:this.$router.fullPath,query:Object(i["a"])(Object(i["a"])({},this.$route.query),{},{page:t.current,limit:10})}),this.pagination.current=t.current)},showModal:function(t){this.visible.flag=!0,this.visible.data=t},handleOk:function(t){this.visible.flag=!1},getInstallmentListSale:function(t){var e=this;this.spinning=!0,this.$store.dispatch("getInstallmentListSale",t).then((function(t){e.installment_list=t.installments})).finally((function(){e.spinning=!1})).catch((function(t){e.$alertMessage(t.response.data.message)}))},onFilterCustomer:function(t){var e=Object(i["a"])({},this.$route.query);e.customerId=t,this.form.date.length&&(e.start_date=this.form.date[0].format("YYYY-MM-DD"),e.end_date=this.form.date[1].format("YYYY-MM-DD"));var a=e;this.$router.push({path:this.$router.fullPath,query:Object(i["a"])(Object(i["a"])({},a),{},{page:1})})},onFilterStatus:function(t){var e=Object(i["a"])({},this.$route.query);e.status=t,this.form.date.length&&(e.start_date=this.form.date[0].format("YYYY-MM-DD"),e.end_date=this.form.date[1].format("YYYY-MM-DD"));var a=e;this.$router.push({path:this.$router.fullPath,query:Object(i["a"])(Object(i["a"])({},a),{},{page:1})})},getCustomerListForInstallments:function(){var t=this;this.$store.dispatch("getCustomerListForInstallments",{}).then((function(e){t.customersList=e.customer}))},getInstallSalementStatuses:function(){var t=this;this.$store.dispatch("getInstallSalementStatuses",{}).then((function(e){t.statusList=e}))},deleteScoring:function(t){}},created:function(){var t=null;this.$isEmptyObj(this.$route.query)?t={limit:10,page:1}:(t=this.$route.query,t.start_date&&(this.form.date=[l()(t.start_date),l()(t.end_date)]),this.pagination.current=parseInt(this.$route.query.page),this.searcher.search=this.$route.query.query);var e={contract_number:t.query,limit:10,offset:t.page?t.page:0,customer_id:"customers"===this.customer?"":this.customer,start_date:this.date_begin,end_date:this.date_end,status:"sale"===this.status?"":this.status};this.getInstallmentListSale(e),this.getCustomerListForInstallments(),this.getInstallSalementStatuses()}},f=m,p=(a("3a33"),a("2877")),_=Object(p["a"])(f,s,r,!1,null,"24979b63",null);e["default"]=_.exports},"3a33":function(t,e,a){"use strict";a("5699")},5699:function(t,e,a){}}]);