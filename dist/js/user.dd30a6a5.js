(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["user"],{1037:function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("a-result",{attrs:{isSuccess:!0,content:!1,title:e.email,"sub-title":e.description},scopedSlots:e._u([{key:"extra",fn:function(){return[s("a-button",{attrs:{size:"large",type:"primary"}},[e._v("查看邮箱")]),s("a-button",{staticStyle:{"margin-left":"8px"},attrs:{size:"large"},on:{click:e.goHomeHandle}},[e._v("返回首页")])]},proxy:!0}])})},a=[],i={name:"RegisterResult",data:function(){return{description:"激活邮件已发送到你的邮箱中，邮件有效期为24小时。请及时登录邮箱，点击邮件中的链接激活帐户。",form:{}}},computed:{email:function(){var e=this.form&&this.form.email||"xxx";return"你的账户：".concat(e," 注册成功")}},created:function(){this.form=this.$route.params},methods:{goHomeHandle:function(){this.$router.push({name:"login"})}}},o=i,n=s("2877"),l=Object(n["a"])(o,r,a,!1,null,"4a6c53ae",null);t["default"]=l.exports},1348:function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"main user-layout-register"},[e._m(0),s("a-form",{ref:"formRegister",attrs:{form:e.form,id:"formRegister"}},[s("a-form-item",[s("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["email",{rules:[{required:!0,type:"email",message:"请输入邮箱地址"}],validateTrigger:["change","blur"]}],expression:"['email', {rules: [{ required: true, type: 'email', message: '请输入邮箱地址' }], validateTrigger: ['change', 'blur']}]"}],attrs:{size:"large",type:"text",placeholder:"邮箱"}})],1),s("a-popover",{attrs:{placement:"rightTop",trigger:["focus"],getPopupContainer:function(e){return e.parentElement}},model:{value:e.state.passwordLevelChecked,callback:function(t){e.$set(e.state,"passwordLevelChecked",t)},expression:"state.passwordLevelChecked"}},[s("template",{slot:"content"},[s("div",{style:{width:"240px"}},[s("div",{class:["user-register",e.passwordLevelClass]},[e._v("强度："),s("span",[e._v(e._s(e.passwordLevelName))])]),s("a-progress",{attrs:{percent:e.state.percent,showInfo:!1,strokeColor:e.passwordLevelColor}}),s("div",{staticStyle:{"margin-top":"10px"}},[s("span",[e._v("请至少输入 6 个字符。请不要使用容易被猜到的密码。")])])],1)]),s("a-form-item",[s("a-input-password",{directives:[{name:"decorator",rawName:"v-decorator",value:["password",{rules:[{required:!0,message:"至少6位密码，区分大小写"},{validator:this.handlePasswordLevel}],validateTrigger:["change","blur"]}],expression:"['password', {rules: [{ required: true, message: '至少6位密码，区分大小写'}, { validator: this.handlePasswordLevel }], validateTrigger: ['change', 'blur']}]"}],attrs:{size:"large",placeholder:"至少6位密码，区分大小写"},on:{click:e.handlePasswordInputClick}})],1)],2),s("a-form-item",[s("a-input-password",{directives:[{name:"decorator",rawName:"v-decorator",value:["password2",{rules:[{required:!0,message:"至少6位密码，区分大小写"},{validator:this.handlePasswordCheck}],validateTrigger:["change","blur"]}],expression:"['password2', {rules: [{ required: true, message: '至少6位密码，区分大小写' }, { validator: this.handlePasswordCheck }], validateTrigger: ['change', 'blur']}]"}],attrs:{size:"large",placeholder:"确认密码"}})],1),s("a-form-item",[s("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["mobile",{rules:[{required:!0,message:"请输入正确的手机号",pattern:/^1[3456789]\d{9}$/},{validator:this.handlePhoneCheck}],validateTrigger:["change","blur"]}],expression:"['mobile', {rules: [{ required: true, message: '请输入正确的手机号', pattern: /^1[3456789]\\d{9}$/ }, { validator: this.handlePhoneCheck } ], validateTrigger: ['change', 'blur'] }]"}],attrs:{size:"large",placeholder:"11 位手机号"}},[s("a-select",{attrs:{slot:"addonBefore",size:"large",defaultValue:"+86"},slot:"addonBefore"},[s("a-select-option",{attrs:{value:"+86"}},[e._v("+86")]),s("a-select-option",{attrs:{value:"+87"}},[e._v("+87")])],1)],1)],1),s("a-row",{attrs:{gutter:16}},[s("a-col",{staticClass:"gutter-row",attrs:{span:16}},[s("a-form-item",[s("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["captcha",{rules:[{required:!0,message:"请输入验证码"}],validateTrigger:"blur"}],expression:"['captcha', {rules: [{ required: true, message: '请输入验证码' }], validateTrigger: 'blur'}]"}],attrs:{size:"large",type:"text",placeholder:"验证码"}},[s("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"mail"},slot:"prefix"})],1)],1)],1),s("a-col",{staticClass:"gutter-row",attrs:{span:8}},[s("a-button",{staticClass:"getCaptcha",attrs:{size:"large",disabled:e.state.smsSendBtn},domProps:{textContent:e._s(e.state.smsSendBtn?e.state.time+" s":"获取验证码")},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.getCaptcha.apply(null,arguments)}}})],1)],1),s("a-form-item",[s("a-button",{staticClass:"register-button",attrs:{size:"large",type:"primary",htmlType:"submit",loading:e.registerBtn,disabled:e.registerBtn},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.handleSubmit.apply(null,arguments)}}},[e._v("注册 ")]),s("router-link",{staticClass:"login",attrs:{to:{name:"login"}}},[e._v("使用已有账户登录")])],1)],1)],1)},a=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("h3",[s("span",[e._v("注册")])])}],i=s("5530"),o=(s("ac1f"),s("498a"),s("7ded")),n=s("705f"),l={0:"低",1:"低",2:"中",3:"强"},c={0:"error",1:"error",2:"warning",3:"success"},u={0:"#ff0000",1:"#ff0000",2:"#ff7e05",3:"#52c41a"},d={name:"Register",components:{},mixins:[n["a"]],data:function(){return{form:this.$form.createForm(this),state:{time:60,smsSendBtn:!1,passwordLevel:0,passwordLevelChecked:!1,percent:10,progressColor:"#FF0000"},registerBtn:!1}},computed:{passwordLevelClass:function(){return c[this.state.passwordLevel]},passwordLevelName:function(){return l[this.state.passwordLevel]},passwordLevelColor:function(){return u[this.state.passwordLevel]}},methods:{handlePasswordLevel:function(e,t,s){var r=0;/[0-9]/.test(t)&&r++,/[a-zA-Z]/.test(t)&&r++,/[^0-9a-zA-Z_]/.test(t)&&r++,this.state.passwordLevel=r,this.state.percent=30*r,r>=2?(r>=3&&(this.state.percent=100),s()):(0===r&&(this.state.percent=10),s(new Error("密码强度不够")))},handlePasswordCheck:function(e,t,s){var r=this.form.getFieldValue("password");void 0===t&&s(new Error("请输入密码")),t&&r&&t.trim()!==r.trim()&&s(new Error("两次密码不一致")),s()},handlePhoneCheck:function(e,t,s){s()},handlePasswordInputClick:function(){this.isMobile?this.state.passwordLevelChecked=!1:this.state.passwordLevelChecked=!0},handleSubmit:function(){var e=this.form.validateFields,t=this.state,s=this.$router;e({force:!0},(function(e,r){e||(t.passwordLevelChecked=!1,s.push({name:"registerResult",params:Object(i["a"])({},r)}))}))},getCaptcha:function(e){var t=this;e.preventDefault();var s=this.form.validateFields,r=this.state,a=this.$message,i=this.$notification;s(["mobile"],{force:!0},(function(e,s){if(!e){r.smsSendBtn=!0;var n=window.setInterval((function(){r.time--<=0&&(r.time=60,r.smsSendBtn=!1,window.clearInterval(n))}),1e3),l=a.loading("hello world..",0);Object(o["a"])({mobile:s.mobile}).then((function(e){setTimeout(l,2500),i["success"]({message:"提示",description:"验证码获取成功，您的验证码为："+e.result.captcha,duration:8})})).catch((function(e){setTimeout(l,1),clearInterval(n),r.time=60,r.smsSendBtn=!1,t.requestFailed(e)}))}}))},requestFailed:function(e){this.$notification["error"]({message:"错误",description:((e.response||{}).data||{}).message||"请求出现错误，请稍后再试",duration:4}),this.registerBtn=!1}},watch:{"state.passwordLevel":function(e){}}},p=d,m=(s("5d18"),s("2ea8"),s("2877")),f=Object(m["a"])(p,r,a,!1,null,"47f8c832",null);t["default"]=f.exports},"1a75":function(e,t,s){},"2ea8":function(e,t,s){"use strict";s("1a75")},"3bb2":function(e,t,s){},"5d18":function(e,t,s){"use strict";s("eeab")},"7c7d":function(e,t,s){},"834c":function(e,t,s){"use strict";s("3bb2")},ac2a:function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"main"},[s("a-form-model",{ref:"ruleForm",staticClass:"user-layout-login",attrs:{model:e.form,rules:e.rules}},[e.isLoginError?s("a-alert",{staticStyle:{"margin-bottom":"24px"},attrs:{type:"error",showIcon:"",message:"ошибка при входе"}}):e._e(),s("a-form-model-item",{ref:"username",attrs:{prop:"username"}},[s("a-input",{attrs:{size:"large",type:"text",placeholder:e.$t("login.form.username")},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}},[s("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"user"},slot:"prefix"})],1)],1),s("a-form-model-item",{ref:"password",attrs:{prop:"password"}},[s("a-input-password",{attrs:{size:"large",placeholder:e.$t("login.form.password")},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}},[s("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"lock"},slot:"prefix"})],1)],1),s("a-form-model-item",{staticStyle:{"margin-top":"24px"}},[s("a-button",{staticClass:"login-button",attrs:{size:"large",type:"primary",htmlType:"submit",loading:e.loginBtn,disabled:e.loginBtn},on:{click:e.onSubmit}},[e._v(e._s(e.$t("login.form.enter")))])],1)],1)],1)},a=[],i=s("5530"),o=(s("ac1f"),s("5319"),s("d3b7"),function(){var e=this,t=this,s=t.$createElement,r=t._self._c||s;return r("a-modal",{attrs:{centered:"",maskClosable:!1},on:{cancel:t.handleCancel},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[r("div",{style:{textAlign:"center"},attrs:{slot:"title"},slot:"title"},[t._v("两步验证")]),r("template",{slot:"footer"},[r("div",{style:{textAlign:"center"}},[r("a-button",{key:"back",on:{click:t.handleCancel}},[t._v("返回")]),r("a-button",{key:"submit",attrs:{type:"primary",loading:t.stepLoading},on:{click:t.handleStepOk}},[t._v(" 继续 ")])],1)]),r("a-spin",{attrs:{spinning:t.stepLoading}},[r("a-form",{attrs:{layout:"vertical","auto-form-create":function(t){e.form=t}}},[r("div",{staticClass:"step-form-wrapper"},[t.stepLoading?r("p",{staticStyle:{"text-align":"center"}},[t._v("Loading..."),r("br"),t._v("请稍后")]):r("p",{staticStyle:{"text-align":"center"}},[t._v("请在手机中打开 Google Authenticator 或两步验证 APP"),r("br"),t._v("输入 6 位动态码")]),r("a-form-item",{style:{textAlign:"center"},attrs:{hasFeedback:"",fieldDecoratorId:"stepCode",fieldDecoratorOptions:{rules:[{required:!0,message:"请输入 6 位动态码!",pattern:/^\d{6}$/,len:6}]}}},[r("a-input",{style:{textAlign:"center"},attrs:{placeholder:"000000"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleStepOk.apply(null,arguments)}}})],1),r("p",{staticStyle:{"text-align":"center"}},[r("a",{on:{click:t.onForgeStepCode}},[t._v("遗失手机?")])])],1)])],1)],2)}),n=[],l={props:{visible:{type:Boolean,default:!1}},data:function(){return{stepLoading:!1,form:null}},methods:{handleStepOk:function(){var e=this,t=this;this.stepLoading=!0,this.form.validateFields((function(s,r){s?(e.stepLoading=!1,e.$emit("error",{err:s})):setTimeout((function(){t.stepLoading=!1,t.$emit("success",{values:r})}),2e3)}))},handleCancel:function(){this.visible=!1,this.$emit("cancel")},onForgeStepCode:function(){}}},c=l,u=(s("834c"),s("2877")),d=Object(u["a"])(c,o,n,!1,null,"5316ea8d",null),p=d.exports,m=s("5880"),f={components:{TwoStepCaptcha:p},data:function(){return{customActiveKey:"tab1",loginBtn:!1,loginType:1,isLoginError:!1,requiredTwoStepCaptcha:!1,stepCaptchaVisible:!1,userType:"1b0444d7-79c2-42d2-b3c5-528be29506a8",form:{username:"",password:""},rules:{username:{required:!0,message:"поле обязательно",trigger:"change"},password:{required:!0,message:"поле обязательно",trigger:"change"}},state:{time:60,loginBtn:!1,loginType:0,smsSendBtn:!1}}},watch:{"form.username":function(e){e!==e.replace(/\s+/g,"")&&(this.form.username=e.replace(/\s+/g,""))},"form.password":function(e){e!==e.replace(/\s+/g,"")&&(this.form.password=e.replace(/\s+/g,""))}},methods:Object(i["a"])(Object(i["a"])({},Object(m["mapActions"])(["Login","Logout"])),{},{handleTabClick:function(e){this.customActiveKey=e},onSubmit:function(){var e=this;this.$refs.ruleForm.validate((function(t){if(!t)return!1;e.loginBtn=!0,e.$store.dispatch("loginBySystemUser",e.form).then((function(t){e.loginSuccess()})).catch((function(t){400===t.response.status&&(e.requestFailed(t.response),e.loginBtn=!1)})).finally((function(){e.loginBtn=!1})),t&&e.$store.dispatch("loginBySystemUserSecond",e.form).then((function(e){})).catch((function(t){400===t.response.status&&(e.requestFailed(t.response),e.loginBtn=!1)})).finally((function(){e.loginBtn=!1}))}))},stepCaptchaSuccess:function(){this.loginSuccess()},stepCaptchaCancel:function(){var e=this;this.Logout().then((function(){e.loginBtn=!1,e.stepCaptchaVisible=!1}))},loginSuccess:function(e){var t=this;this.$router.push({path:"/"}),setTimeout((function(){t.$notification.success({message:"Вы вошли успешно",description:""})}),1e3),this.isLoginError=!1},requestFailed:function(e){var t=this;this.isLoginError=!0,this.$notification["error"]({message:"Логин или пароль неверный",description:((e.response||{}).data||{}).message||"Пожалуйста, попробуйте еще раз",duration:4}),setTimeout((function(){t.state.loginBtn=!1}),600)}})},g=f,h=(s("fa58"),Object(u["a"])(g,r,a,!1,null,"16530782",null));t["default"]=h.exports},eeab:function(e,t,s){},fa58:function(e,t,s){"use strict";s("7c7d")}}]);