(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0e24ba"],{"7da8":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("a-navigation",{attrs:{list:[{name:t.$t("Finance"),link:""},{name:t.$t("GL"),link:""}],isBack:{flag:!1,link:""}}},[n("div",{staticStyle:{display:"flex","justify-content":"flex-end",gap:"10px"}},[n("a-select",{staticStyle:{width:"200px"},attrs:{placeholder:"Год",options:t.years},on:{change:t.onYearSelect},model:{value:t.selectedYear,callback:function(e){t.selectedYear=e},expression:"selectedYear"}}),n("a-select",{staticStyle:{width:"200px"},attrs:{placeholder:"Месяцы",options:t.months},on:{change:t.onMonthSelect},model:{value:t.selectedMonth,callback:function(e){t.selectedMonth=e},expression:"selectedMonth"}}),n("a-range-picker",{staticStyle:{width:"250px"},attrs:{format:"YYYY-MM-DD",value:t.dateRangeValue},on:{change:t.onDateSelect}}),n("a-button",{attrs:{type:"primary",loading:t.downloading,icon:"file-excel"},on:{click:t.download}},[t._v(t._s(t.$t("Export to excel")))])],1)]),n("a-card",[n("a-table",{staticClass:"gl-table",attrs:{bordered:"",scroll:{x:300},pagination:t.pagination,columns:t.staticColumn,loading:t.loading,"data-source":t.gl,customRow:t.onRowClick},on:{change:t.getPagination},scopedSlots:t._u([{key:"dateTime",fn:function(e){return n("span",{},[t._v(" "+t._s(t._f("moment")(e,t.$dateTimeFormat)))])}},{key:"date",fn:function(e){return n("span",{},[t._v(" "+t._s(t._f("moment")(e,t.$dateFormat)))])}},{key:"money",fn:function(e){return n("span",{},[t._v(" "+t._s(t.$moneyFormat(+e))+" ")])}},{key:"id",fn:function(e){return n("span",{staticStyle:{color:"#01CAB0"}},[t._v(" "+t._s(e)+" ")])}}])})],1)],1)},i=[],o=n("2909"),c=n("5530"),d=(n("d3b7"),n("d81d"),n("159b"),n("a434"),n("c1df")),r=n.n(d),l=n("d403"),s={columns:["created_at","date_at","account_from","account_to","operation_type","payment_gateway.name","amount","subconto_debit.title","subconto_debit.title2","count_debit","subconto_credit.title","subconto_credit.title2","count_credit","guid"],header:[[{value:"Cоздано в",span:1,rowSpan:1},{value:"Дата",span:1,rowSpan:1},{value:"Счет Дт",span:1,rowSpan:1},{value:"Счет Кт",span:1,rowSpan:1},{value:"Тип операции",span:1,rowSpan:1},{value:"Платежный шлюз",span:1,rowSpan:1},{value:"Сумма",span:1,rowSpan:1},{value:"Субконто Дт текст 1",span:1,rowSpan:1},{value:"Субконто Дт текст 2",span:1,rowSpan:1},{value:"Количество Дт",span:1,rowSpan:1},{value:"Субконто Кт текст 1",span:1,rowSpan:1},{value:"Субконто Кт текст 2",span:1,rowSpan:1},{value:"Количество Кт",span:1,rowSpan:1},{value:"Идентификатор объекта",span:1,rowSpan:1}]]},u=s,h=n("dcb5"),p={data:function(){var t=this;return{beginDate:null,endDate:null,loading:!1,downloading:!1,dateRangeValue:[],selectedMonth:void 0,selectedYear:void 0,months:this.$store.state.app.months,years:this.$store.state.app.years,keys:{created_at:"Cоздано в",date_at:"Дата",account_from:"Счет Дт",subconto_debit:"Субконто Дт",count_debit:"Количество Дт",account_to:"Счет Кт",subconto_credit:"Субконто Кт",count_credit:"Количество Кт",amount:"Сумма",operation_type:"Тип операции",payment_gateway:"Платежный шлюз",object_id:"Идентификатор объекта"},gl:[],staticColumn:[{title:"№",dataIndex:"data",width:80,align:"center",fixed:"left",customRender:function(e,n,a){var i={children:a/3+1+10*(t.pagination.current-1),attrs:{}};return i.attrs.rowSpan=a%3===0?3:0,i}},{title:"Дата",dataIndex:"date_at",key:"date_at",align:"center",width:160,customRender:function(e,n,a){var i={children:r()(e).format(t.$dateFormat),attrs:{}};return i.attrs.rowSpan=a%3===0?3:0,i}},{title:"Счет Дт",dataIndex:"account_from",key:"account_from",align:"center",width:160,customRender:function(t,e,n){var a={children:t,attrs:{}};return a.attrs.rowSpan=n%3===0?3:0,a}},{title:"Субконто Дт",width:160,children:[{title:"",width:160,children:[{title:"",data:"subconto_debit",width:160,customRender:function(t,e,n){var a={children:t,attrs:{}};return n%3===0&&e.subconto_debit&&e.subconto_debit.title&&(a.children=e.subconto_debit.title),n%3===1&&e.subconto_debit&&e.subconto_debit.title2&&(a.children=e.subconto_debit.title2),a}}]}]},{title:"Количество Дт",dataIndex:"count_debit",width:160,align:"center",children:[{title:"Валюта Дт",dataIndex:"data32",width:160,align:"center",children:[{title:"Вал. сумма Дт",dataIndex:"data33",width:160,align:"center",customRender:function(t,e,n){var a={children:t,attrs:{}};return n%3===0&&e.count_debit&&(a.children=e.count_debit),n%3===1&&e.data32&&(a.children=e.data32),a}}]}]},{title:"Счет Кт",dataIndex:"account_to",width:160,align:"center",customRender:function(t,e,n){var a={children:t,attrs:{}};return a.attrs.rowSpan=n%3===0?3:0,a}},{title:"Субконто Кт",width:160,align:"center",children:[{title:"",width:160,align:"center",children:[{title:"",dataIndex:"subconto_credit",width:160,align:"center",customRender:function(t,e,n){var a={children:t,attrs:{}};return n%3===0&&e.subconto_credit&&e.subconto_credit.title&&(a.children=e.subconto_credit.title),n%3===1&&e.subconto_credit&&e.subconto_credit.title2&&(a.children=e.subconto_credit.title2),a}}]}]},{title:"Количество Кт",dataIndex:"count_credit",width:160,align:"center",children:[{title:"Валюта Кт",dataIndex:"data62",width:160,align:"center",children:[{title:"Вал. сумма Кт",dataIndex:"data63",width:160,align:"center",customRender:function(t,e,n){var a={children:t,attrs:{}};return n%3===0&&e.count_credit&&(a.children=e.count_credit),n%3===1&&e.data62&&(a.children=e.data62),a}}]}]},{title:"Сумма",dataIndex:"amount",width:160,align:"center",children:[{title:"Содержание",dataIndex:"data72",width:160,align:"center",children:[{title:"Номер журнала",dataIndex:"data73",width:160,align:"center",customRender:function(e,n,a){var i={children:e,attrs:{}};return a%3===0&&n.amount&&(i.children=t.$moneyFormat(+n.amount)),a%3===1&&n.data72&&(i.children=n.data72),i}}]}]}],pagination:{current:1,pageSize:30,showQuickJumper:!0},query:{begin_date:"",end_date:""}}},methods:{download:function(t){var e=this;this.downloading=!0,this.$store.dispatch("getGL",{page:1,all:!0,limit:1e6,begin_date:this.beginDate,end_date:this.endDate}).then((function(t){var e=t.gl_list.map((function(t){var e,n,a,i;return Object(c["a"])(Object(c["a"])({},t),{},{created_at:r()(t.created_at).format("DD.MM.YYYY HH:mm:ss"),date_at:r()(t.date_at).format("DD.MM.YYYY"),subconto_credit:{title:(null===(e=t.subconto_credit)||void 0===e?void 0:e.title)||"",title2:(null===(n=t.subconto_credit)||void 0===n?void 0:n.title2)||""},subconto_debit:{title:(null===(a=t.subconto_debit)||void 0===a?void 0:a.title)||"",title2:(null===(i=t.subconto_debit)||void 0===i?void 0:i.title2)||""}})})),n=Object(l["a"])(e,u);Object(h["a"])(n,{columns:u.columns.map((function(){return{width:28}})),fileName:"GL.xlsx"})})).finally((function(){e.downloading=!1}))},onDateSelect:function(t,e){this.dateRangeValue=t,this.pagination.current=1,this.beginDate=e[0],this.endDate=e[1],this.getGL()},onMonthSelect:function(t){var e,n=r()().set("month",t),a=null!==(e=this.selectedYear)&&void 0!==e?e:r()().format("YYYY");n.set("year",a);var i=[n.startOf("month").format("YYYY-MM-DD"),n.endOf("month").format("YYYY-MM-DD")],o=[r()(i[0]),r()(i[1])];this.onDateSelect(o,i)},onYearSelect:function(t){var e,n=r()().set("year",t),a=null!==(e=this.selectedMonth)&&void 0!==e?e:r()().format("M")-1;n.set("month",a);var i=[n.startOf("month").format("YYYY-MM-DD"),n.endOf("month").format("YYYY-MM-DD")],o=[r()(i[0]),r()(i[1])];this.onDateSelect(o,i)},onRowClick:function(t,e){var n=this;return{on:{click:function(e){n.$router.push({name:"update_shared",params:{id:t.guid}})}}}},getPagination:function(t){this.pagination.current=t.current,this.getGL()},getGL:function(t){var e=this;this.loading=!0,this.$store.dispatch("getGL",{limit:10,page:this.pagination.current,begin_date:this.beginDate,end_date:this.endDate}).then((function(t){e.gl=Object(o["a"])(t.gl_list),t.gl_list&&t.gl_list.length&&t.gl_list.forEach((function(t,n){e.gl.splice(3*(n+1)-2,0,t),e.gl.splice(3*(n+1)-1,0,t)}));var n=Object(c["a"])({},e.pagination);n.total=3*t.count,e.pagination=n})).finally((function(){e.loading=!1}))}},created:function(){this.getGL({page:1,limit:10})}},_=p,g=n("2877"),m=Object(g["a"])(_,a,i,!1,null,"22f7d116",null);e["default"]=m.exports}}]);