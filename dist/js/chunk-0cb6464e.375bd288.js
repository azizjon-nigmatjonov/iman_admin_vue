(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0cb6464e"],{"15fd":function(t,e,a){"use strict";a.d(e,"a",(function(){return s}));a("a4d3"),a("b64b");function n(t,e){if(null==t)return{};var a,n,s={},i=Object.keys(t);for(n=0;n<i.length;n++)a=i[n],e.indexOf(a)>=0||(s[a]=t[a]);return s}function s(t,e){if(null==t)return{};var a,s,i=n(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)a=o[s],e.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(t,a)&&(i[a]=t[a])}return i}},2909:function(t,e,a){"use strict";a.d(e,"a",(function(){return l}));var n=a("6b75");function s(t){if(Array.isArray(t))return Object(n["a"])(t)}a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0"),a("a630");function i(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}var o=a("06c5");function r(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(t){return s(t)||i(t)||Object(o["a"])(t)||r()}},5730:function(t,e,a){t.exports=a.p+"assets/pdf.1800da4a.svg"},"5e4e":function(t,e,a){t.exports=a.p+"assets/docs.b168f4c9.svg"},7143:function(t,e,a){"use strict";var n=a("1da1"),s=(a("96cf"),a("d3b7"),{data:function(){return{fileList:[],previewImage:"",previewVisible:!1,uploadingImage:!1}},methods:{uploadImage:function(t){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var n,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e.uploadingImage=!0,n=new FormData,n.append("file",t.file),a.next=5,e.$getBase64(t.file);case 5:s=a.sent,e.$store.dispatch("uploadImage",n).then((function(t){e.fileList.push({uid:t.filename,name:t.filename,status:"done",url:s})})).catch((function(t){})).finally((function(){e.uploadingImage=!1}));case 7:case"end":return a.stop()}}),a)})))()},handleChange:function(t){var e=t.fileList;0===e.length&&(this.fileList=e)},handlePreview:function(t){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t.url||t.preview){a.next=4;break}return a.next=3,e.$getBase64(t.originFileObj);case 3:t.preview=a.sent;case 4:e.previewImage=t.url||t.preview,e.previewVisible=!0;case 6:case"end":return a.stop()}}),a)})))()}}});e["a"]=s},"72d7":function(t,e,a){t.exports=a.p+"assets/excel.79dfea41.svg"},8831:function(t,e,a){"use strict";a("a3b8")},"931c":function(t,e,a){t.exports=a.p+"assets/image.eb5d81af.svg"},"9f02":function(t,e,a){t.exports=a.p+"assets/word.a60c33da.svg"},a3b8:function(t,e,a){},c345:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"navbar"},[n("a-navigation",{attrs:{list:[{name:t.$t("Мусавамa"),link:"/installment/list"},{name:t.$t("3аявки"),link:""}],isBack:{flag:!0,return:!0},noBorder:""}}),t.installment.is_deleted?n("a-button",{attrs:{type:"primary"},on:{click:t.restoreBond}},[t._v(t._s(t.$t("Восстановить")))]):n("a-button",{attrs:{type:"danger"},on:{click:t.deleteBond}},[t._v(t._s(t.$t("delete_bond")))])],1),n("a-card",{staticClass:"no-space-tab"},[n("a-tabs",{attrs:{"default-active-key":"1"}},[n("a-tab-pane",{key:"1",attrs:{tab:t.$t("Детали рассрочки")}},[n("a-card",{staticClass:"no-border-card",attrs:{title:t.$t("Детали рассрочки")}},[n("a-form-model",[n("a-row",{attrs:{gutter:16}},[n("a-col",{attrs:{lg:8,md:12}},[n("a-form-model-item",{attrs:{label:"Дата создания",prop:"min_investment_amount"}},[n("a-date-picker",{staticStyle:{width:"100%"},attrs:{"show-time":"",placeholder:"Select Time",format:t.$dateTimeFormat,disabled:""},model:{value:t.installment.created_at,callback:function(e){t.$set(t.installment,"created_at",e)},expression:"installment.created_at"}})],1)],1),n("a-col",{attrs:{lg:8,md:12}},[n("a-form-model-item",{attrs:{label:"Сумма рассрочки",prop:"min_investment_amount"}},[n("a-input-number",{staticStyle:{width:"100%"},attrs:{disabled:"",formatter:function(t){return t.replace(/(?=(\d{3})+(?!\d))/g," ")},parser:function(t){return t.replace(/\s?|(,*)/g,"")}},model:{value:t.installment.installment_amount,callback:function(e){t.$set(t.installment,"installment_amount",e)},expression:"installment.installment_amount"}})],1)],1),n("a-col",{attrs:{lg:8,md:12}},[n("a-form-model-item",{attrs:{label:"Стоимость товара",prop:"min_investment_amount"}},[n("a-input-number",{staticStyle:{width:"100%"},attrs:{disabled:"",formatter:function(t){return t.replace(/(?=(\d{3})+(?!\d))/g," ")},parser:function(t){return t.replace(/\s?|(,*)/g,"")}},model:{value:t.installment.total_price,callback:function(e){t.$set(t.installment,"total_price",e)},expression:"installment.total_price"}})],1)],1),n("a-col",{attrs:{lg:8,md:12}},[n("a-form-model-item",{attrs:{label:"Количество месяцев срока",prop:"min_investment_amount"}},[n("a-input-number",{staticStyle:{width:"100%"},attrs:{disabled:""},model:{value:t.installment.period_month_count,callback:function(e){t.$set(t.installment,"period_month_count",e)},expression:"installment.period_month_count"}})],1)],1),n("a-col",{attrs:{lg:8,md:12}},[n("a-form-model-item",{attrs:{label:"Статус",prop:"min_investment_amount"}},[n("a-input",{staticStyle:{width:"100%"},attrs:{value:t.installment.status,disabled:""}})],1)],1),n("a-col",{attrs:{lg:8,md:12}},[n("a-form-model-item",{attrs:{label:"Статус автопогашение",prop:"min_investment_amount"}},[n("a-input",{staticStyle:{width:"100%"},attrs:{value:t.installment.auto_payment?"Активный":"Неактивный",disabled:""}})],1)],1),t.installment.reject_reason?n("a-col",{attrs:{lg:8,md:12}},[n("a-form-model-item",{attrs:{label:"Причина отказа",prop:"min_investment_amount"}},[n("a-input",{staticStyle:{width:"100%"},attrs:{value:t.$t(t.installment.reject_reason),disabled:""}})],1)],1):t._e(),t.installment.discount?n("a-col",{attrs:{lg:8,md:12}},[n("a-form-model-item",{attrs:{label:"discount",prop:"min_investment_amount"}},[n("a-input",{staticStyle:{width:"100%"},attrs:{value:t.$t(t.installment.discount),disabled:""}})],1)],1):t._e(),t.installment.downpayment?n("a-col",{attrs:{lg:8,md:12}},[n("a-form-model-item",{attrs:{label:"downpayment",prop:"min_investment_amount"}},[n("a-input",{staticStyle:{width:"100%"},attrs:{value:t.$t(t.installment.downpayment),disabled:""}})],1)],1):t._e(),t.installment.installment_amount?n("a-col",{attrs:{lg:8,md:12}},[n("a-form-model-item",{attrs:{label:"installment_amount",prop:"min_investment_amount"}},[n("a-input",{staticStyle:{width:"100%"},attrs:{value:t.$t(t.installment.installment_amount),disabled:""}})],1)],1):t._e(),t.installment.shelf_price?n("a-col",{attrs:{lg:8,md:12}},[n("a-form-model-item",{attrs:{label:"shelf_price",prop:"min_investment_amount"}},[n("a-input",{staticStyle:{width:"100%"},attrs:{value:t.$t(t.installment.shelf_price),disabled:""}})],1)],1):t._e()],1)],1)],1)],1),n("a-tab-pane",{key:"3",attrs:{tab:t.$t("repaymentSchedule")}},[n("repayment-schedule-tab",{ref:"repaymentSheduleRef",attrs:{status:t.installment.status,is_edited:t.installment.is_edited}})],1),n("a-tab-pane",{key:"9",attrs:{tab:t.$t("installmentTransactions")}},[n("transaction-tab",{attrs:{contractNumber:t.contract_number},on:{updateSchedule:t.updateRepaymentSchedule}})],1),n("a-tab-pane",{key:"4",attrs:{tab:t.$t("Товары")}},[n("a-card",[n("a-table",{attrs:{"row-key":function(t){return t.guid},bordered:"",scroll:{x:2e3,y:700},pagination:!1,columns:t.columns1,"data-source":t.account,customRow:t.customRowClick},scopedSlots:t._u([{key:"created_at",fn:function(e){return n("span",{},[t._v(" "+t._s(t._f("moment")(e.created_at,t.$dateFormat)))])}},{key:"invoice_date",fn:function(e){return n("span",{},[t._v(" "+t._s(t._f("moment")(e.invoice_date,t.$dateFormat)))])}},{key:"verified",fn:function(e){return n("span",{},[t._v(" "+t._s(t.verify(e.verified)))])}},{key:"responsible_person",fn:function(e){return n("span",{},[t._v(" "+t._s(t.getSystemUser(e.responsible_person)))])}},{key:"products",fn:function(e){return n("span",{},[t._v(" "+t._s(e.products_count)+" ")])}}])},[n("span",{staticClass:"span",attrs:{slot:"actions"},slot:"actions"},[n("a-tooltip",{attrs:{placement:"bottomLeft",title:t.$t("button.add")}},[n("a-button",{staticClass:"mx-1",attrs:{type:"primary",icon:"plus"},nativeOn:{click:function(e){return e.stopPropagation(),t.ok.apply(null,arguments)}}})],1)],1)])],1)],1),n("a-tab-pane",{key:"5",attrs:{tab:t.$t("statusChangeHistory")}},[n("logs-tab")],1),n("a-tab-pane",{key:"6",attrs:{tab:t.$t("files")}},[n("a-card",[n("h3",{style:{marginBottom:"16px"}},[t._v(" "+t._s(t.$t("documents"))+" ")]),n("a-list",{attrs:{"data-source":t.array0},scopedSlots:t._u([{key:"renderItem",fn:function(e){return n("a-list-item",{},[n("a-list-item-meta",[n("span",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(e.title))]),"photo"===e.format?n("img",{attrs:{slot:"avatar",width:"25",height:"25",src:a("931c")},slot:"avatar"}):"pdf"===e.format?n("img",{attrs:{slot:"avatar",width:"25",height:"25",src:a("5730")},slot:"avatar"}):"doc"===e.format?n("img",{attrs:{slot:"avatar",width:"25",height:"25",src:a("9f02")},slot:"avatar"}):"excel"===e.format?n("img",{attrs:{slot:"avatar",width:"25",height:"25",src:a("72d7")},slot:"avatar"}):n("img",{attrs:{slot:"avatar",width:"25",height:"25",src:a("5e4e")},slot:"avatar"})]),n("div",[n("a-row",{attrs:{type:"flex"}},[n("a-col",{attrs:{span:"auto"}},["pdf"===e.format?n("a",{attrs:{href:e.file,target:"blank",disabled:!e.file}},[n("icon-btn",{attrs:{icon:"eye",tooltip:t.$t("button.preview")}})],1):"doc"===e.format||"docx"===e.format?n("icon-btn",{attrs:{icon:"eye",tooltip:t.$t("button.preview")},on:{click:function(a){return t.go(e)}}}):n("icon-btn",{attrs:{icon:"eye",tooltip:t.$t("button.preview")},on:{click:function(a){t.imageFile=e.file,t.visibleImage=!0}}})],1),n("a-col",{attrs:{span:"auto"}},[n("icon-btn",{attrs:{tooltip:t.$t("button.download"),icon:"download",color:"green"},on:{click:function(a){return t.download(e)}}})],1)],1)],1)],1)}}])}),t.imageFile?n("a-modal",{attrs:{title:t.$t("Investor"),footer:null,width:700},model:{value:t.visibleImage,callback:function(e){t.visibleImage=e},expression:"visibleImage"}},[n("center",[n("img",{staticStyle:{"max-width":"100%",margin:"0 auto"},attrs:{src:t.imageFile,alt:t.imageFile.split("/").pop()}})])],1):t._e(),n("h3",{style:{marginBottom:"16px",marginTop:"20px"}},[t._v(" "+t._s(t.$t("documentsOfClient"))+" ")]),n("a-list",{attrs:{"data-source":t.customerFiles},scopedSlots:t._u([{key:"renderItem",fn:function(e){return n("a-list-item",{},[n("a-list-item-meta",[n("span",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(e.title))]),"photo"===e.format||"png"===e.format||"jpg"===e.format?n("img",{attrs:{slot:"avatar",width:"25",height:"25",src:a("931c")},slot:"avatar"}):"pdf"===e.format?n("img",{attrs:{slot:"avatar",width:"25",height:"25",src:a("5730")},slot:"avatar"}):"doc"===e.format?n("img",{attrs:{slot:"avatar",width:"25",height:"25",src:a("9f02")},slot:"avatar"}):"excel"===e.format?n("img",{attrs:{slot:"avatar",width:"25",height:"25",src:a("72d7")},slot:"avatar"}):n("img",{attrs:{slot:"avatar",width:"25",height:"25",src:a("5e4e")},slot:"avatar"})]),n("div",[n("a-row",{attrs:{type:"flex"}},[n("a-col",{attrs:{span:"auto"}},["pdf"===e.format?n("a",{attrs:{href:e.file,target:"blank",disabled:!e.file}},[n("icon-btn",{attrs:{icon:"eye",tooltip:t.$t("button.preview")}})],1):"doc"===e.format||"docx"===e.format?n("icon-btn",{attrs:{icon:"eye",tooltip:t.$t("button.preview")},on:{click:function(a){return t.go(e)}}}):n("icon-btn",{attrs:{icon:"eye",tooltip:t.$t("button.preview")},on:{click:function(a){t.imageFile=e.file,t.visibleImage=!0}}})],1),n("a-col",{attrs:{span:"auto"}},[n("icon-btn",{attrs:{tooltip:t.$t("button.download"),icon:"download",color:"green"},on:{click:function(a){return t.download(e)}}})],1)],1)],1)],1)}}])})],1),"agreement_accept"===t.status_list||"done"===t.status_list?n("a-card",[n("div",[n("a-upload",{attrs:{name:"file",customRequest:t.uploadFile,"file-list":[]}},[n("a-button",[n("a-icon",{attrs:{type:t.fileUploadLoading?"loading":"upload"}}),t._v(" Click to Upload ")],1)],1)],1)]):t._e()],1),n("a-tab-pane",{key:"7",attrs:{tab:t.$t("wingsRequest")}},[n("a-card",{staticClass:"no-border-card"})],1),n("a-tab-pane",{key:"8",attrs:{tab:t.$t("wingsResponse")}},[n("a-card",{staticClass:"no-border-card"})],1)],1),this.accounts?n("a-modal",{attrs:{title:t.$t("addInvoice"),"on-ok":"handleOk"},on:{ok:t.addInvoice,cancel:t.handleCancel},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[[n("a-form-model",{attrs:{span:12,colon:!1}},[n("a-col",{staticStyle:{padding:"0 15px"}},[n("a-form-model-item",{attrs:{label:t.$t("invoice_date"),prop:"invoice_date"}},[n("a-date-picker",{attrs:{format:t.$dateFormat},model:{value:t.invoice_date,callback:function(e){t.invoice_date=e},expression:"invoice_date"}})],1)],1),n("a-col",{staticStyle:{padding:"0 15px"}},[n("a-form-model-item",{attrs:{label:t.$t("invoice_number"),prop:"invoice_number"}},[n("a-input",{model:{value:t.invoice_number,callback:function(e){t.invoice_number=e},expression:"invoice_number"}})],1)],1)],1)]],2):t._e()],1)],1)},s=[],i=a("2909"),o=a("15fd"),r=a("1da1"),l=a("5530"),c=(a("96cf"),a("d3b7"),a("ac1f"),a("1276"),a("9911"),a("fb6a"),a("b0c0"),a("d81d"),a("4fadc"),a("caad"),a("2532"),a("4de4"),a("99af"),a("3ca3"),a("ddb0"),a("2b3d"),a("9861"),a("5880")),u=a("7143"),d=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-table",{attrs:{"row-key":function(t){return t.created_at},bordered:"",scroll:{x:1500},pagination:!1,columns:t.columns,"data-source":t.data},scopedSlots:t._u([{key:"created_at",fn:function(e){return a("span",{},[t._v(t._s(t._f("moment")(e.created_at,t.$dateTimeFormat))+" ")])}},{key:"data.dateBirth",fn:function(e){return a("span",{},[t._v(t._s(t._f("moment")(e.data.dateBirth,t.$dateFormat))+" ")])}},{key:"data.dateIssue",fn:function(e){return a("span",{},[t._v(t._s(t._f("moment")(e.data.dateIssue,t.$dateFormat))+" ")])}},{key:"data.firstName",fn:function(e){return a("span",{},[t._v(t._s(e.data.firstName+" "+e.data.lastName+" "+e.data.middleName)+" ")])}},{key:"data.docSeries",fn:function(e){return a("span",{},[t._v(t._s(e.data.docSeries+" "+e.data.docNumber)+" ")])}},{key:"testers",fn:function(e){return a("span",{},[a("span",{style:"color: white; background: "+t.getStatusName(e.status).color+"; padding: 5px 15px; border-radius: 6px"},[t._v(t._s(t.getStatusName(e.status).text))])])}}])})],1)},m=[],p={data:function(){return{data:[],columns:[{title:"ФИО",scopedSlots:{customRender:"data.firstName"},key:"data.firstName"},{title:"Дата рождения",scopedSlots:{customRender:"data.dateBirth"},key:"data.dateBirth"},{title:"Телефонный номер",dataIndex:"data.phone",key:"data.phone"},{title:"Номер паспорта",scopedSlots:{customRender:"data.docSeries"},key:"data.docSeries"},{title:"Выданs",dataIndex:"data.issueBy",key:"data.issueBy"},{title:"Дата выпуска",scopedSlots:{customRender:"data.dateIssue"},key:"data.dateIssue"},{title:"Дата",scopedSlots:{customRender:"created_at"},key:"created_at"},{title:"Статус ",scopedSlots:{customRender:"testers"},key:"testers",width:"20%"}]}},methods:{getKatchDetails:function(t){var e=this;this.$store.dispatch("getKatchDetails",t).then((function(t){e.data=t.results}))},getStatusName:function(t){var e={};switch(t){case"claim_registered":e={text:"Регистрация кредитной заявки",color:"#1E88E5"};break;case"rejected":e={text:"Отказ в выдаче кредита",color:"#E53935"};break;case"contract_registered":e={text:"Регистрация кредита",color:"#FFC107"};break;case"contract_schedule_added":e={text:"Добавлен графика погашения кредита",color:"#4CAF50"};break;default:e={color:"",text:"-"};break}return e}},created:function(){this.getKatchDetails(this.$route.params.id)}},f=p,h=a("2877"),_=Object(h["a"])(f,d,m,!1,null,null,null),g=_.exports,v=a("931c"),b=a.n(v),y=a("5e4e"),$=a.n(y),k=a("c1df"),w=a.n(k),S=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-card",[a("a-table",{attrs:{bordered:"",pagination:!1,columns:t.columns,"data-source":t.logs,loading:t.loading},scopedSlots:t._u([{key:"user",fn:function(e){return a("span",{},[t._v(" "+t._s(t.$t(e.user&&e.user.name||""))+" ")])}},{key:"status",fn:function(e){return a("span",{},[t._v(" "+t._s(t.$t(e.status))+" ")])}},{key:"date",fn:function(e){return a("span",{},[t._v(" "+t._s(t._f("moment")(e.created_at,t.$dateFormat))+" ")])}}])}),t.rejectSelectVisivle?a("a-form-model",{ref:"ruleForm",attrs:{model:t.form}},[a("div",{staticClass:"mb-2",staticStyle:{display:"flex","align-items":"center","justify-content":"flex-end","margin-top":"20px"}},[a("div",{staticStyle:{"margin-right":"10px"}},[t._v(" "+t._s(t.$t("changeStatus"))+": ")]),a("a-select",{staticStyle:{width:"100%","max-width":"300px","margin-right":"10px"},on:{change:t.onStatusChange},model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},[a("a-select-option",{attrs:{value:t.lastStatus.status}},[t._v(" "+t._s(t.$t(t.lastStatus.status))+" ")]),t.statusSelectVisible?t._l(t.filteredStatus,(function(e){return a("a-select-option",{key:e.status_id,attrs:{value:e.status}},[t._v(" "+t._s(t.$t(e.status))+" ")])})):t._e()],2),a("a-button",{attrs:{type:"primary",loading:t.changing},on:{click:t.onChangeStatus}},[t._v(" "+t._s(t.$t("save"))+" ")])],1),a("a-row",{attrs:{type:"flex",justify:"end"}},[a("a-col",{attrs:{md:12,span:24}},[a("a-form-model-item",{ref:"comment",attrs:{label:t.$t("commentary"),prop:"comment"}},[a("a-textarea",{attrs:{placeholder:t.$t("Описание"),"max-length":255},model:{value:t.form.comment,callback:function(e){t.$set(t.form,"comment",e)},expression:"form.comment"}})],1)],1)],1)],1):t._e()],1)},x=[],I=(a("7db0"),{data:function(){return{logs:[],loading:!1,statusList:[],changing:!1,statusSelectVisible:!1,rejectSelectVisivle:!1,rules:{comment:{required:!0,message:"Пожалуйста, введите комментарий",trigger:"change"}},lastStatus:{status:"reject",status_id:3},form:{comment:"",status_id:void 0,status:""},columns:[{title:this.$t("status"),scopedSlots:{customRender:"status"},key:"status"},{title:this.$t("date"),scopedSlots:{customRender:"date"},key:"date"},{title:this.$t("whoChanged"),scopedSlots:{customRender:"user"},key:"user"},{title:this.$t("commentary"),dataIndex:"comment",key:"comment"}]}},mounted:function(){this.getLogs(),this.getStatuses()},computed:{filteredStatus:function(){return this.statusList.filter((function(t){return"done"===t.status}))}},methods:{onStatusChange:function(t){var e=this.statusList.find((function(e){return e.status===t}));this.form.status_id=e.status_id},getLogs:function(){var t=this;this.loading=!0,this.$store.dispatch("getApplicationLogs",this.$route.params.id).then((function(e){var a,n,s,i=e.logs,o=null===(a=e.logs)||void 0===a?void 0:a.length;t.logs=i,"agreement_accept"===(null===(n=i[o-1])||void 0===n?void 0:n.status)?t.statusSelectVisible=!0:t.statusSelectVisible=!1,"reject"!==(null===(s=i[o-1])||void 0===s?void 0:s.status)?t.rejectSelectVisivle=!0:t.rejectSelectVisivle=!1})).catch((function(t){})).finally((function(){t.loading=!1}))},getStatuses:function(){var t=this;this.$store.dispatch("getApplicationStatuses",{}).then((function(e){t.statusList=e.statuses})).catch((function(t){}))},onChangeStatus:function(){var t=this;this.changing=!0,this.$store.dispatch("updateApplicationStatus",{id:this.$route.params.id,data:this.form}).then((function(e){t.form.comment="",t.getLogs()})).catch((function(t){})).finally((function(){t.changing=!1}))}}}),j=I,D=Object(h["a"])(j,S,x,!1,null,"9b2453ee",null),F=D.exports,R=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-card",{attrs:{title:t.$t("total.amount.transactions")+": "+t.$moneyFormat(t.totalAmount)}},[a("div",{attrs:{slot:"extra"},slot:"extra"},[a("a-button",{attrs:{type:"primary"},on:{click:t.openModal}},[t._v(t._s(t.$t("add.transaction")))])],1),a("a-table",{attrs:{loading:t.loader,columns:t.columns,"data-source":t.tableData,pagination:!1},scopedSlots:t._u([{key:"payment_type",fn:function(e){return a("span",{},[t._v(" "+t._s(t.$t(e))+" ")])}},{key:"dateTime",fn:function(e){return a("span",{},[t._v(" "+t._s(t._f("moment")(e,t.$dateTimeFormat))+" ")])}},{key:"status",fn:function(e){return a("span",{},[a("a-tag",{attrs:{color:t.getStatusColor(e.status)}},[t._v(t._s("success"===e.status?"Проверено":t.$t(e.status)))])],1)}},{key:"type",fn:function(e){return a("span",{},[e?a("a-tag",{attrs:{color:t.getColor(e)}},[t._v(t._s(t.getStatus(e)))]):a("span")],1)}},{key:"date",fn:function(e,n){return a("span",{},[n.overall?a("b",[t._v(" "+t._s(t.getDateOrText(e))+" ")]):a("span",[t._v(" "+t._s(t.getDateOrText(e))+" ")])])}},{key:"amount",fn:function(e){return a("span",{},[t._v(" "+t._s(t.$moneyFormat(e)))])}},{key:"money",fn:function(e){return a("span",{},[t._v(" "+t._s(t.$moneyFormat(+e))+" ")])}}])}),a("a-modal",{attrs:{title:t.$t("add.transaction"),okType:"primary",okText:"Добавить","confirm-loading":t.modalLoading},on:{ok:t.addTransactions},model:{value:t.modalVisible,callback:function(e){t.modalVisible=e},expression:"modalVisible"}},[a("div",{staticStyle:{display:"flex","align-items":"center","justify-content":"center","margin-top":"40px"}},[a("a-form-item",{staticStyle:{width:"300px"},attrs:{validateStatus:t.inputError?"error":"",required:!0,extra:t.inputError,label:"Сумма",colon:!0,labelAlign:"left","label-col":{span:6},"wrapper-col":{span:18}}},[a("a-input-number",{staticStyle:{width:"100%"},attrs:{formatter:function(t){return(""+t).replace(/\B(?=(\d{3})+(?!\d))/g,",")},parser:function(t){return t.replace(/\$\s?|(,*)/g,"")}},model:{value:t.inputedAmount,callback:function(e){t.inputedAmount=e},expression:"inputedAmount"}})],1)],1)])],1)},O=[],C=(a("159b"),{props:["contractNumber"],data:function(){return{tableData:[],inputedAmount:0,loader:!0,modalVisible:!1,modalLoading:!1,columns:[{title:this.$t("transactionId"),key:"transaction_id",dataIndex:"transaction_id"},{title:this.$t("created_at"),scopedSlots:{customRender:"dateTime"},key:"created_at",dataIndex:"created_at"},{title:this.$t("amount"),scopedSlots:{customRender:"money"},key:"amount",dataIndex:"amount"},{title:this.$t("payment_type"),key:"payment_type",dataIndex:"payment_type",scopedSlots:{customRender:"payment_type"}},{title:this.$t("status"),scopedSlots:{customRender:"status"},key:"status"}]}},mounted:function(){this.fetchTransactionList()},computed:{totalAmount:function(){var t;if(null===(t=this.tableData)||void 0===t||!t.length)return 0;var e=0;return this.tableData.forEach((function(t){e+=t.amount})),e}},methods:{fetchTransactionList:function(){var t=this;this.loader=!0,this.$store.dispatch("getInstallmentTransactions",this.$route.params.id).then((function(e){t.tableData=e.bond_payment})).finally((function(){t.loader=!1}))},getStatusColor:function(t){var e;switch(t){case"success":e="cyan";break;default:e="orange"}return e},addTransactions:function(){var t=this;this.modalLoading=!0,this.$store.dispatch("createInstallmentTransaction",{amount:this.inputedAmount,contract_number:this.contractNumber}).then((function(e){t.modalVisible=!1,t.fetchTransactionList(),t.$emit("updateSchedule")})).finally((function(){t.modalLoading=!1}))},openModal:function(){this.modalVisible=!0}},watch:{modalVisible:function(t){t&&(this.inputedAmount=0)}}}),T=C,L=Object(h["a"])(T,R,O,!1,null,null,null),V=L.exports,A=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-card",{attrs:{title:t.$t("prepayment")+": "+t.$moneyFormat(t.tableData.downpayment)}},[a("a-table",{attrs:{columns:t.columns,"data-source":t.computedTableData,pagination:!1},scopedSlots:t._u([{key:"status",fn:function(e){return a("span",{},[e?a("a-tag",{attrs:{color:t.getColor(e)}},[t._v(t._s(t.getStatus(e)))]):a("span")],1)}},{key:"date",fn:function(e,n){return a("span",{},[n.overall?a("b",[t._v(" "+t._s(t.getDateOrText(e))+" ")]):a("span",[t._v(" "+t._s(t.getDateOrText(e))+" ")])])}},{key:"amount",fn:function(e){return a("span",{},[t._v(" "+t._s(t.$moneyFormat(e)))])}},{key:"discounted_amount",fn:function(e){return a("span",{},[t._v(" "+t._s(t.$moneyFormat(e.discounted_amount)))])}},{key:"money",fn:function(e){return a("span",{},[t._v(" "+t._s(t.$moneyFormat(+e))+" ")])}}])}),"done"!==t.status||t.isEdited?t._e():a("a-card",[t.datePickerVisible?a("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[a("div",[a("a-date-picker",{staticStyle:{width:"250px","margin-right":"20px"},attrs:{"disabled-date":t.disabledDate},model:{value:t.selectedDate,callback:function(e){t.selectedDate=e},expression:"selectedDate"}}),a("a-button",{attrs:{type:"primary"},on:{click:t.changeDate}},[t._v("Изменит")])],1),t.acceptButtonVisible?a("a-button",{attrs:{type:"primary"},on:{click:t.confirmClick}},[t._v("Подтвердить")]):t._e()],1):a("a-button",{attrs:{type:"primary"},on:{click:function(e){t.datePickerVisible=!0}}},[t._v("Изменить дату")])],1)],1)},B=[],P={props:["status","is_edited"],data:function(){return{tableData:[],datePickerVisible:!1,selectedDate:null,acceptButtonVisible:!1,isEdited:this.is_edited,columns:[{title:this.$t("date"),dataIndex:"date",scopedSlots:{customRender:"date"},key:"date"},{title:this.$t("debtAmount"),dataIndex:"amount",scopedSlots:{customRender:"money"},key:"debt"},{title:this.$t("interest"),dataIndex:"interest",scopedSlots:{customRender:"money"},key:"interest"},{title:this.$t("amount"),scopedSlots:{customRender:"amount"},dataIndex:"sum",key:"amount"},{title:this.$t("discounted_amount"),scopedSlots:{customRender:"discounted_amount"},key:"discounted_amount"},{title:this.$t("status"),scopedSlots:{customRender:"status"},key:"status"}]}},mounted:function(){this.getTableData()},watch:{is_edited:function(t){this.isEdited=this.is_edited}},computed:{repayments:function(){var t;return(null===(t=this.tableData)||void 0===t?void 0:t.repayment)||[]},computedTableData:function(){var t;if(null===(t=this.repayments)||void 0===t||!t.length)return[];var e=0,a=0,n=this.repayments.some((function(t){return"not_paid"===t.status})),s=this.repayments.map((function(t){return e+=t.amount,a+=t.interest,Object(l["a"])(Object(l["a"])({},t),{},{sum:+t.amount+ +t.interest})}));return s.push({date:"Итого:",overall:!0}),s.push({date:"".concat(this.tableData.months," ").concat(this.$t("months")),amount:e,interest:a,sum:a+e,status:n?"not_fully_paid":"fully_paid"}),s},computedStartDate:function(){var t,e,a=w()();return null===(t=this.repayments.filter((function(t){return w()(t.date)>a})))||void 0===t||null===(e=t[0])||void 0===e?void 0:e.date}},methods:{confirmClick:function(){var t=this;this.$store.dispatch("editRepaymentSchedule",{id:this.$route.params.id,data:{repayment_schedule:{repayment_schedule:this.repayments,status:"alternative"}}}).then((function(e){t.$alertMessage("success","Успешно","Дата успешно обновлена",t),t.isEdited=!0}))},changeDate:function(){var t=this;if(!this.selectedDate)return this.datePickerVisible=!1,null;var e=0,a=w()();this.tableData.repayment=this.tableData.repayment.map((function(n,s){var i=w()(n.date);return i<a?n:(e++,Object(l["a"])(Object(l["a"])({},n),{},{date:1===e?t.selectedDate.format("YYYY-MM-DD"):t.selectedDate.add(1,"month").format("YYYY-MM-DD")}))})),this.selectedDate=null,this.acceptButtonVisible=!0},disabledDate:function(t){var e=this.computedStartDate?w()(this.computedStartDate):null;if(!e)return!1;var a=["29","30","31"];return t&&(t<e||t>e.add(1,"month").endOf("day")||a.includes(t.format("DD")))},getTableData:function(){var t=this;this.$store.dispatch("getRepaymentSchedule",this.$route.params.id).then((function(e){var a;t.tableData=null===(a=e.repayment_schedule)||void 0===a?void 0:a[0]}))},getColor:function(t){return"not_paid"===t.status?"orange":"paid"===t.status?"green":"not_fully_paid"===t.status?"yellow":"fully_paid"===t.status?"cyan":void 0},getStatus:function(t){return"not_paid"===t.status?"Не оплачено":"not_fully_paid"===t.status?"Полностью не оплачен":"fully_paid"===t.status?"Полностью оплачен":"paid"===t.status?"Оплачено":void 0},getDateOrText:function(t){return t|w()(this.$dateFormat)?w()(this.$dateFormat):t}}},N=P,E=Object(h["a"])(N,A,B,!1,null,null,null),M=E.exports,U=["files"],q={mixins:[u["a"]],components:{katmTable:g,images:b.a,docs:$.a,LogsTab:F,TransactionTab:V,RepaymentScheduleTab:M},data:function(){return{imageFile:"",visibleImage:!1,repaymentSchedule:[],previewVisiblePhoto:!1,previewImagePhoto:"",previewVisiblePass:!1,previewImagePass:"",visible:!1,visible1:!1,wingsData:{},userName:"",link:"https://view.officeapps.live.com/op/embed.aspx?src=",installment:{},file1:"",file2:"",file3:"",customerFiles:[],array0:[],array:{},array1:{},array2:{},repayment_schedule:[],additional_contacts:[],verified:!0,phone_number:"",contract_number:"",created_at:"",installment_amount:0,name:"",branch_name:"",invoice_date:"",invoice_number:"",commentary:"",guid:"",responsible_person:"",account:[],accounts:{},status_list:"",fileUploadLoading:!1,columns0:[{title:"Значок",scopedSlots:{customRender:"icon"},key:"icon"},{title:"Имя файла",scopedSlots:{customRender:"file"},key:"file"},{title:this.$t("category.table.Actions"),scopedSlots:{customRender:"actions"},key:"actions",width:220}],columns2:[{title:this.$t("first_name"),dataIndex:"first_name",key:"first_name"},{title:this.$t("last_name"),dataIndex:"last_name",key:"last_name"},{title:this.$t("phone_number"),dataIndex:"phone_number",key:"phone_number"},{title:this.$t("whom"),dataIndex:"family_relation.data.name_ru",key:"family_relation.data.name_ru"}],columnsCard:[{title:this.$t("Card_number"),dataIndex:"card_number",key:"card_number"},{title:this.$t("card_expiry_month"),dataIndex:"card_expiry_month",key:"card_expiry_month"},{title:this.$t("card_expiry_year"),dataIndex:"card_expiry_year",key:"card_expiry_year"}],columns1:[{title:this.$t("created at"),scopedSlots:{customRender:"created_at"},width:100,key:"created_at"},{title:this.$t("products"),scopedSlots:{customRender:"products"},key:"products",width:100},{title:this.$t("installment_amount"),dataIndex:"price",key:"installment_amount"},{title:this.$t("quantity"),dataIndex:"quantity",key:"amount"},{title:this.$t("merchant"),dataIndex:"name",key:"name"},{title:this.$t("category"),dataIndex:"category",key:"category"}],installmentTransactions:[],photoFiles:[],passportFiles:[],uploadingImage:!1,uploadingImagePass:!1}},watch:{visibleImage:function(t,e){t||(this.imageFile="")},installment:function(t){},array0:function(t){}},computed:Object(l["a"])({},Object(c["mapGetters"])(["system_users"])),methods:{getInstallmentTransactions:function(){var t=this;this.$store.dispatch("getInstallmentTransactions",this.$route.params.id).then((function(e){t.installmentTransactions=e.bond_payment}))},deleteBond:function(){var t=this;this.$store.dispatch("deleteBondSelf",this.$route.params.id).then((function(e){t.$alertMessage("success",t.$t("bond_deleted_successfully"),"",t),t.$router.push({name:"installment-list"})}))},restoreBond:function(){var t=this;this.$store.dispatch("restoreBond",{id:this.$route.params.id,data:this.installment}).then((function(e){t.$alertMessage("success",t.$t("Bond restored successfully"),"",t),t.$router.push({name:"installment-list"})}))},uploadFile:function(t){var e=this;this.fileUploadLoading=!0;var a=new FormData;a.append("file",t.file),this.$store.dispatch("upload",a).then((function(t){var a,n;e.$store.dispatch("addNewContract",{id:null===(a=e.installment)||void 0===a||null===(n=a.customer)||void 0===n?void 0:n.customer_id,guid:e.installment.guid,data:{file_name_1:"",file_name_2:"",file_name_3:t.filename}}).then((function(){e.array0.push({file:"https://test.cdn.iman.uz/iman/".concat(t.filename),title:t.filename,key:t.filename,format:t.filename.split(".").pop()})}))})).catch((function(t){})).finally((function(){e.fileUploadLoading=!1}))},customRowClick:function(t){var e=this;return{on:{click:function(a){e.$router.push({name:"products-list",params:{id:t.guid}})}}}},uploadImage:function(t){var e=this;this.uploadingImage=!0,this.$uploadImage(t.file,this.photoFiles,this).then((function(){e.uploadingImage=!1})).catch((function(){e.uploadingImage=!1}))},handleChange:function(t,e){var a=t.photoFiles;0===a.length&&(this[e?"photoFiles":"passportFiles"]=a)},handlePreview:function(t,e){var a=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.url||t.preview){n.next=4;break}return n.next=3,a.$getBase64(t.originFileObj);case 3:t.preview=n.sent;case 4:a[e?"previewImagePhoto":"previewImagePass"]=t.url||t.preview,a[e?"previewVisiblePhoto":"previewVisiblePass"]=!0;case 6:case"end":return n.stop()}}),n)})))()},getDateOrText:function(t){return t|w()(this.$dateFormat)?w()(this.$dateFormat):t},getInquiry:function(){var t=this;this.$store.dispatch("getInquiryData",{id:this.$route.params.id}).then((function(e){t.wingsData=e}))},go:function(t){window.open("photo"!==t.format?this.link+t.file:t.file,"_blank")},getColor:function(t){return"not_paid"===t.status?"orange":"paid"===t.status?"green":"not_fully_paid"===t.status?"yellow":"fully_paid"===t.status?"cyan":void 0},getStatus:function(t){return"not_paid"===t.status?"Не оплачено":"not_fully_paid"===t.status?"Полностью не оплачен":"fully_paid"===t.status?"Полностью оплачен":"paid"===t.status?"Оплачено":void 0},Nullcheck:function(t,e){return e.length>1?t[e[0]]&&this.Nullcheck(t[e[0]],e.slice(1))||null:t[e[0]]||null},getSystemUser:function(t){var e=this;return this.$store.dispatch("getSystemUser",t).then((function(t){e.userName=t.name})),this.userName},verify:function(t){return!0===t?"Да":"Нет"},how:function(){},getSingleScoring:function(t){var e=this;this.$store.dispatch("getSingleScoringApp",this.$route.params.id).then((function(t){var a;e.installment=t,e.status_list=t.installment.status;var n=["svg","png","jpg","jpeg"],s=Object.entries(t.installment.attachments).pop()[1].map((function(t){var e=t.split(".").pop();return{file:t,key:t,title:t.split("/").pop(),format:null!==e&&void 0!==e&&e.includes("doc")?"doc":null!==e&&void 0!==e&&e.includes("pdf")?"pdf":null!==e&&void 0!==e&&e.includes("xls")?"excel":n.includes(e)?"photo":"file"}})),r=t.installment.attachments,c=(r.files,Object(o["a"])(r,U));e.array0=Object.entries(c).map((function(t){var e=t[1].split(".").pop();return{file:t[1],title:t[1].split("/").pop(),key:Math.random(),format:e.includes("doc")?"doc":e.includes("pdf")?"pdf":e.includes("xls")?"excel":n.includes(e)?"photo":"file"}})).filter((function(t){return t})),e.getInstallmentCustomerFiles(e.installment.customer.customer_id),e.array0=[].concat(Object(i["a"])(e.array0),Object(i["a"])(s)),e.additional_contacts=e.installment.customer.additional_contacts.map((function(t){return Object(l["a"])(Object(l["a"])({},t),{},{key:400*Math.random()})})),e.verified=e.installment.verified,e.phone_number=null===(a=e.installment.customer.personal_info)||void 0===a?void 0:a.phone_number,e.contract_number=e.installment.contract_number,e.created_at=e.installment.created_at,e.installment_amount=e.installment.installment_amount,e.name=e.installment.merchant.merchant.name,e.branch_name=e.installment.merchant.merchant_branch.name,e.invoice_date=e.installment.invoice_date,e.invoice_number=e.installment.invoice_number,e.commentary=e.installment.invoice_number,e.guid=e.installment.guid,e.responsible_person=e.installment.responsible_person,e.accounts.verified=e.verified,e.accounts.responsible_person=e.responsible_person,e.accounts.phone_number=e.phone_number,e.accounts.contract_number=e.contract_number,e.accounts.created_at=e.created_at,e.accounts.installment_amount=e.installment_amount,e.accounts.name=e.name,e.accounts.branch_name=e.branch_name,e.accounts.invoice_date=e.invoice_date,e.accounts.invoice_number=e.invoice_number,e.accounts.commentary=e.commentary,e.accounts.guid=e.guid,e.accounts.products_count=e.installment.products&&e.installment.products.length||0,e.installment.created_at=w()(e.installment.created_at).subtract(5,"hours"),e.photoFiles=[{uid:e.installment.customer.passport.photo_document.split("/").pop(),url:e.installment.customer.passport.photo_document,status:"done",name:e.installment.customer.passport.photo_document}],e.passportFiles=[{uid:e.installment.customer.passport.passport_photo.split("/").pop(),url:e.installment.customer.passport.passport_photo,status:"done",name:e.installment.customer.passport.passport_photo}],e.fileList=[{uid:t.installment.attachments.file_name_3.split("/").pop(),url:t.installment.attachments.file_name_3,status:"done",name:t.installment.attachments.file_name_3}]}))},getApplicationProducts:function(){var t=this;this.$store.dispatch("getApplicationProducts",this.$route.params.id).then((function(e){t.account=e})).catch((function(t){})).finally((function(){}))},getInstallmentCustomerFiles:function(t){var e=this;this.$store.dispatch("getInstallmentCustomerFiles",t).then((function(t){var a=["svg","png","jpg","jpeg"];e.customerFiles=Object.entries(t).map((function(t){var e=t[1].split(".").pop();return{file:t[1],title:t[1].split("/").pop(),key:Math.random(),format:e.includes("doc")?"doc":e.includes("pdf")?"pdf":e.includes("xls")?"excel":a.includes(e)?"photo":"file"}}))})).catch((function(t){}))},download:function(t){return Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,fetch(t.file).then((function(t){return t.blob()})).then((function(e){var a=document.createElement("a");a.href=window.URL.createObjectURL(new Blob([e])),a.setAttribute("download","photo"===t.format?"image.jpg":t.file),document.body.appendChild(a),a.click()}));case 2:case"end":return e.stop()}}),e)})))()},handleCancel:function(t){this.visible=!1},ok:function(){this.visible=!0},acceptScore:function(t){var e=this;this.$store.dispatch("acceptScoring",this.$route.params.id).then((function(t){e.$alertMessage("success","Accepted","Scoring has accepted successfully",e),e.$router.go(-1)})).catch((function(t){e.$alertMessage(t.response.data.message)}))},dust:function(){return{id:this.installment.guid,data:{invoice_date:this.invoice_date,invoice_number:this.invoice_number}}},addInvoice:function(){var t=this;this.$store.dispatch("addInvoice",this.dust()).then((function(e){t.$message.success("Invoice has added successfully"),t.visible=!1,location.reload()}))},rejectScore:function(t){var e=this;this.$store.dispatch("rejectScoring",this.$route.params.id).then((function(t){e.$alertMessage("success","Rejected","Scoring has rejected successfully",e),e.$router.go(-1)}))},startScoring:function(t){var e=this;this.$store.dispatch("startScoring",t.guid).then((function(a){t.scoring_status=a.status,e.$alertMessage("success","Accepted","Scoring has started successfully",e),e.$router.go(-1)}))},updateRepaymentSchedule:function(){this.$refs.repaymentSheduleRef.getTableData()}},created:function(t){this.getInstallmentTransactions(),this.getSingleScoring(t),this.getInquiry(),this.getApplicationProducts()}},Y=q,K=(a("8831"),Object(h["a"])(Y,n,s,!1,null,"39068f82",null));e["default"]=K.exports}}]);