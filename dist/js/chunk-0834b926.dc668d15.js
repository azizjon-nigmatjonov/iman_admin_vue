(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0834b926"],{"91d6":function(t,e,a){},b8fd:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-navigation",{attrs:{list:[{name:t.$t("Мусавамa")}],isBack:{flag:!1,link:"/installments"},noBorder:""}},[a("div",{staticStyle:{float:"right"}},[a("a-select",{staticStyle:{"margin-right":"10px",width:"200px"},attrs:{placeholder:t.$t("status")},on:{change:t.onFilterStatus},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}},[a("a-select-option",{attrs:{value:""}},[t._v(" "+t._s(t.$t("all"))+" ")]),t._l(t.statusList,(function(e){return a("a-select-option",{key:e.Slug,attrs:{value:e.Slug}},[t._v(" "+t._s(t.$t(e.Name))+" ")])}))],2),a("a-button",{attrs:{type:"primary",icon:"file-excel"},on:{click:t.download}},[t._v(t._s(t.$t("Export to excel")))])],1)]),a("a-card",{staticClass:"no-space-tab"},[a("a-card",[a("div",{staticClass:"mb-3"},[a("a-form-model",{ref:"ruleForm",attrs:{colon:!1,layout:"horizontal",rules:t.rules,model:t.form}},[a("a-row",{attrs:{type:"flex",justify:"space-between",gutter:[16,16]}},[a("a-col",{attrs:{md:6}},[a("a-select",{attrs:{placeholder:t.$t("customers")},on:{change:t.onFilterCustomer},model:{value:t.customer,callback:function(e){t.customer=e},expression:"customer"}},t._l(t.customersList,(function(e){return a("a-select-option",{key:e.guid,attrs:{value:e.guid}},[t._v(" "+t._s(t.$t(e.first_name))+" ")])})),1)],1),a("a-col",{attrs:{md:6}},[a("a-form-model-item",{attrs:{prop:"date"}},[a("a-range-picker",{staticStyle:{width:"100%"},attrs:{format:"YYYY-MM-DD","show-time":{hideDisabledOptions:!1}},on:{change:t.filterInput3},model:{value:t.form.date,callback:function(e){t.$set(t.form,"date",e)},expression:"form.date"}})],1)],1)],1)],1)],1),a("a-table",{attrs:{columns:t.columns,"data-source":t.installment_list,"row-key":function(t){return t.guid},pagination:t.pagination,loading:t.spinning,scroll:{x:1500},bordered:"",rowClassName:function(t){return"done"===t.status?"table-row-green "+(t.is_deleted?"table-row-orange":""):t.is_deleted?"table-row-orange":""}},on:{change:t.getPagination},scopedSlots:t._u([{key:"customer.birthday",fn:function(e){return a("span",{},[t._v(" "+t._s(t._f("moment")(e.customer.birthday,t.$dateFormat))+" ")])}},{key:"created_at",fn:function(e){return a("span",{},[t._v(" "+t._s(t._f("moment")(e.created_at,t.$dateTimeFormat))+" ")])}},{key:"pos_agent",fn:function(e){return a("span",{},[t._v(" "+t._s(e.pos_agent.first_name+" "+e.pos_agent.last_name)+" "),a("br"),t._v(" "+t._s(e.pos_agent.phone_number)+" ")])}},{key:"merchant_branch",fn:function(e){return a("span",{},[t._v(" "+t._s(e.merchant.merchant.name+" /  "+e.merchant.merchant_branch.name)+" ")])}},{key:"contract_number",fn:function(e){return a("span",{},[t._v(" "+t._s(e.contract_number.slice(3))+" ")])}},{key:"amount_per_month",fn:function(e){return a("span",{},[t._v(" "+t._s(t.$moneyFormat(e.amount_per_month))+" ")])}},{key:"installment_amount",fn:function(e){return a("span",{},[t._v(" "+t._s(t.$moneyFormat(e.installment_amount))+" ")])}},{key:"status",fn:function(e){return a("span",{},[a("a-tag",{attrs:{color:t.getStatusColor(e.status)}},[t._v(t._s("done"===e.status?"Проверено":t.$t(e.status)))])],1)}},{key:"scoring_status",fn:function(e){return a("span",{},[a("a-tag",{attrs:{color:t.getStatusColor(e.scoring_status)}},[t._v(t._s(e.scoring_status))])],1)}},{key:"actions",fn:function(e){return a("span",{},[a("a-tooltip",{attrs:{placement:"bottomLeft",title:t.$t("button.preview")}},[a("a-button",{staticClass:"mx-1",attrs:{type:"primary",icon:"edit"},on:{click:function(a){return t.$router.push({name:"edit scroing",params:{id:e.guid}})}}})],1)],1)}}])})],1)],1)],1)},r=[],n=a("5530"),i=(a("ac1f"),a("1276"),a("841c"),a("5319"),a("d3b7"),a("b047")),o=a.n(i),u=a("c1df"),c=a.n(u),l={data:function(){return this.filterInput=o()(this.filterInput,500),{statusList:[],currentTab:"3аявки",customersList:[],customer:"customers",typeList:["Все","3аявки","Приход","Продажа","Успешный"],status:this.$route.path.split("/")[3],spinning:!1,vis:!1,visible:{flag:!1,data:{customer:{}}},rules:{date:[{required:!0,message:"Пожалуйста, введите дату",trigger:"blur"}]},pagination:{current:1,showQuickJumper:!0},installment_list:[],searcher:{search:""},form:{date:[]},date_begin:"",date_end:"",columns:[{title:this.$t("Created_at"),scopedSlots:{customRender:"created_at"},key:"created_at",customCell:this.onRowCLickFunc},{title:this.$t("installment_amount"),dataIndex:"installment_amount",key:"installment_amount"},{title:this.$t("shelf_price"),dataIndex:"shelf_price",key:"shelf_price"},{title:this.$t("bonds.table.status"),scopedSlots:{customRender:"status"},key:"status",width:160,customCell:this.onRowCLickFunc}]}},watch:{"$route.query":{handler:function(){var t=null;this.$isEmptyObj(this.$route.query)?t={limit:10,page:1}:(t=this.$route.query,t.start_date&&(this.form.date=[c()(t.start_date),c()(t.end_date)]),this.pagination.current=parseInt(this.$route.query.page),this.searcher.search=this.$route.query.query,this.status=this.$route.query.status);var e={contract_number:t.query,offset:t.page?t.page-1:0,customer_id:"customers"===this.customer?"":this.customer,branch_id:"",pos_agent_id:"",start_date:t.start_date,end_date:t.end_date};this.getInstallmentListApp(e)}}},methods:{moment:c.a,onFilterStatus:function(t){var e=Object(n["a"])({},this.$route.query);e.status=t,this.status=t,e.page=1,this.pagination.current=1,this.$router.replace({query:e}),this.searcher.search},getStatuses:function(){var t=this;this.$store.dispatch("getApplicationStatuses",{}).then((function(e){t.statusList=e})).catch((function(t){}))},onRowCLickFunc:function(t,e){var a=this;return{on:{click:function(e){a.$router.push({name:"edit scroing",params:{id:t.guid}})}}}},onTabChange:function(t){this.currentTab=t},filterInput:function(t){var e=Object(n["a"])({},this.$route.query);e.page=1,this.status&&(e.status=this.status),e.query=this.searcher.search,this.form.date.length&&(e.start_date=this.form.date[0].format("YYYY-MM-DD"),e.end_date=this.form.date[1].format("YYYY-MM-DD")),this.$router.push({path:this.$router.fullPath,query:Object(n["a"])(Object(n["a"])({},e),{},{page:1})})},getInstallmentSearch:function(t){var e=this;this.spinning=!0,this.$store.dispatch("getInstallmentSearch",t).then((function(t){e.installment_list=t.installment_list;var a=Object(n["a"])({},e.pagination);a.total=t.count,e.pagination=a})).finally((function(){e.spinning=!1})).catch((function(t){e.$alertMessage(t.response.data.message)}))},filterInput3:function(t){var e={};e=t&&t.length?{start_date:t[0].format("YYYY-MM-DD"),end_date:t[1].format("YYYY-MM-DD")}:{start_date:void 0,end_date:void 0},this.status&&(e.status=this.status),this.searcher.search?(e.query=this.searcher.search,this.$router.push({path:this.$router.fullPath,query:Object(n["a"])(Object(n["a"])(Object(n["a"])({},this.$route.query),e),{},{page:1})})):this.$router.replace({query:e})},download:function(t){var e=this;t.preventDefault(),this.$refs.ruleForm.validate((function(t,a){if(t){e.date_begin=e.form.date[0].format("YYYY-MM-DD"),e.date_end=e.form.date[1].format("YYYY-MM-DD");var s={start:e.date_begin,end:e.date_end};e.$store.dispatch("getInstallmentReports",s).then((function(t){var e=t.filename,a=document.createElement("a");a.href=e,a.setAttribute("download","File"),document.body.appendChild(a),a.click()})).catch((function(t){e.$message.error(t.response.data.error)}))}}))},getStatusColor:function(t){var e;switch(t){case"closed":e="cyan";break;case"done":e="green";break;case"reject":e="red";break;case"new":e="green";break;case"pending":e="orange";break;case"passed":e="#87d068";break;case"not-passed":e="red";break;case"accept_by_customer":e="purple";break;case"scoring_failed":e="red";break;default:e=""}return e},getPagination:function(t){this.searcher.search?(this.$router.push({path:this.$router.fullPath,query:Object(n["a"])(Object(n["a"])({},this.$route.query),{},{page:t.current,limit:10,query:this.searcher.search})}),this.pagination.current=t.current):(this.$router.push({path:this.$router.fullPath,query:Object(n["a"])(Object(n["a"])({},this.$route.query),{},{page:t.current,limit:10})}),this.pagination.current=t.current)},showModal:function(t){this.visible.flag=!0,this.visible.data=t},handleOk:function(t){this.visible.flag=!1},getInstallmentListApp:function(t){var e=this;this.spinning=!0,this.$store.dispatch("getInstallmentListApp",t).then((function(t){e.installment_list=t.applications||[];var a=Object(n["a"])({},e.pagination);a.total=t.count,e.pagination=a})).finally((function(){e.spinning=!1})).catch((function(t){e.$alertMessage(t.response.data.message)}))},onFilterCustomer:function(t){var e=Object(n["a"])({},this.$route.query);e.customerId=t,this.form.date.length&&(e.start_date=this.form.date[0].format("YYYY-MM-DD"),e.end_date=this.form.date[1].format("YYYY-MM-DD"));var a=e;this.$router.push({path:this.$router.fullPath,query:Object(n["a"])(Object(n["a"])({},a),{},{page:1})})},getCustomerListForInstallments:function(){var t=this;this.$store.dispatch("getCustomerListForInstallments",{}).then((function(e){t.customersList=e.customer}))},deleteScoring:function(t){}},created:function(){var t=null;this.$isEmptyObj(this.$route.query)?t={limit:10,page:1}:(t=this.$route.query,t.start_date&&(this.form.date=[c()(t.start_date),c()(t.end_date)]),this.pagination.current=parseInt(this.$route.query.page),this.searcher.search=this.$route.query.query,this.status=this.$route.query.status);var e={contract_number:t.query,offset:t.page?t.page:0,customer_id:"customers"===this.customer?"":this.customer,branch_id:"",pos_agent_id:"",start_date:"",end_date:""};this.getInstallmentListApp(e),this.getStatuses(),this.getCustomerListForInstallments()}},h=l,d=(a("d116"),a("2877")),m=Object(d["a"])(h,s,r,!1,null,"33f3f9b2",null);e["default"]=m.exports},d116:function(t,e,a){"use strict";a("91d6")}}]);