(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-18a89d3a"],{"0d0f":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("a-navigation",{attrs:{list:[{name:e.$t("Роли"),link:"/system/roles"},{name:e.$route.params.id?e.$t("button.edit"):e.$t("Добавить"),link:""}],isBack:{flag:!0,return:!0},noBorder:""}}),r("a-card",{staticClass:"no-border-card no-pt-body-card",attrs:{title:e.$route.params.id?e.$t("button.edit"):"Cоздание роли"}},[r("a-form-model",{ref:"ruleForm",attrs:{colon:!1,model:e.form,rules:e.rules}},[r("a-row",{staticClass:"form-row",attrs:{gutter:16}},[r("a-col",{attrs:{span:8}},[r("a-form-model-item",{ref:"name",attrs:{label:"Название",prop:"name"}},[r("a-input",{attrs:{placeholder:"название роли"},on:{blur:function(){e.$refs.name.onFieldBlur()}},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1),r("a-col",{attrs:{span:8}},[r("a-form-model-item",{ref:"name",attrs:{label:"Тип пользователя",prop:"user_type_id"}},[r("a-select",{attrs:{disabled:"","default-value":e.userTypes[0].id}},[r("a-select-option",{attrs:{value:e.userTypes[0].id}},[e._v(" "+e._s(e.userTypes[0].name)+" ")])],1)],1)],1)],1)],1)],1),r("a-row",{staticClass:"edit-btns mt-4"},[r("a-col",{attrs:{span:"24"}},[r("a-form-model-item",[r("a-row",{attrs:{type:"flex",justify:"end"}},[r("a-col",{attrs:{span:"auto"}},[r("a-button",{staticStyle:{"margin-right":"6px"},attrs:{type:"grey",loading:e.loading},on:{click:e.cancelPost}},[e._v(" "+e._s(e.$t("button.cancel"))+" ")]),e.isNewForm?r("a-button",{attrs:{loading:e.loading,type:"primary"},on:{click:e.postUserRole}},[e._v(e._s(e.$t("button.create"))+" ")]):r("a-button",{attrs:{loading:e.loading,type:"primary"},on:{click:e.updateUserRole}},[e._v(e._s(e.$t("button.save"))+" ")])],1)],1)],1)],1)],1),e.$route.params.id?r("a-card",[r("a-row",{staticStyle:{"margin-bottom":"20px","margin-top":"10px"}},[r("a-input",{staticClass:"search-input",attrs:{placeholder:e.$t("search")},model:{value:e.searchText,callback:function(t){e.searchText=t},expression:"searchText"}})],1),r("a-row",[r("a-col",{attrs:{span:"auto"}},[r("a-table",{attrs:{columns:e.columns,"data-source":e.computedTableData,bordered:"",loading:e.loadingTable},scopedSlots:e._u([{key:"action",fn:function(t){return r("span",{},[r("a-col",{attrs:{span:"auto"}},[r("a-switch",{attrs:{checked:e.filteredScopes.includes(t.id)},on:{change:function(r){return e.handleSwitch(r,t.id)}}})],1)],1)}}],null,!1,4028461801)})],1)],1)],1):e._e()],1)},s=[],o=r("2909"),n=r("1da1"),i=(r("96cf"),r("4de4"),r("d3b7"),r("caad"),r("2532"),r("ac1f"),r("5319"),r("d81d"),r("99af"),{data:function(){return{loading:!1,loadingTable:!1,isNewForm:!1,searchText:"",form:{name:"",user_type_id:"a828e458-7488-49b8-a717-c33972603704"},rules:{name:[{required:!0,message:"Пожалуйста, введите имя репетитора",trigger:"blur"}]},scopes:[],filteredScopes:[],columns:[{title:"Название",key:"url",dataIndex:"url"},{title:this.$t("table.actions"),key:"action",width:200,scopedSlots:{customRender:"action"}}]}},computed:{userTypes:function(){return this.$store.getters.getUserTypes},computedTableData:function(){var e,t=this;return null===(e=this.scopes)||void 0===e?void 0:e.filter((function(e){return e.url.includes(t.searchText)}))}},methods:{handleSwitch:function(e,t){e?(this.addUserRoleScope(t),this.filteredScopes.push(t)):(this.filteredScopes=this.filteredScopes.filter((function(e){return e!==t})),this.removeUserRoleScope(t))},addUserRoleScope:function(e){this.$store.dispatch("postUserRoleScopes",{scope_id:e,user_role_id:this.$route.params.id})},removeUserRoleScope:function(e){this.$store.dispatch("deleteUserRoleScope",{user_role_id:this.$route.params.id,scope_id:e})},postUserRole:function(){var e=this;if(!this.$isValid(this))return this.$formValidationError("warning","Form required","Please provide all fields",this),-1;this.$store.dispatch("postUserRole",this.form).then((function(t){e.$alertMessage("success","Role","Role created successfully",e),e.cancelPost()})).finally((function(){e.loading=!1}))},getUserRole:function(e){var t=this;this.$store.dispatch("getUserRole",e).then((function(e){t.form=e}))},updateUserRole:function(){var e=this;if(!this.$isValid(this))return this.$formValidationError("warning","Form required","Please provide all fields",this),-1;this.$store.dispatch("updateUserRole",this.form).then((function(t){e.$alertMessage("success","Role","Role has updated successfully",e),e.cancelPost()})).finally((function(){e.loading=!1}))},cancelPost:function(){this.$router.replace("/system/roles")},handleSubmit:function(e){},fetchItems:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r,a,s,n,i,c,l,u,d,p;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loadingTable=!0,t.prev=1,t.next=4,e.$store.dispatch("getScopes");case 4:return s=t.sent,n=s.scopes,t.next=8,e.$store.dispatch("getUserRoleScopes",{id:e.$route.params.id,limit:1e3});case 8:i=t.sent,c=i.user_role_scopes,l=c.map((function(e){return e.scope_id})),e.filteredScopes=l,u=null!==(r=n.filter((function(e){return l.includes(e.id)})))&&void 0!==r?r:[],d=null!==(a=n.filter((function(e){return!l.includes(e.id)})))&&void 0!==a?a:[],p=[].concat(Object(o["a"])(u),Object(o["a"])(d)),e.scopes=p,t.next=20;break;case 18:t.prev=18,t.t0=t["catch"](1);case 20:return t.prev=20,e.loadingTable=!1,t.finish(20);case 23:case"end":return t.stop()}}),t,null,[[1,18,20,23]])})))()}},created:function(){this.$isEmptyObj(this.$route.params)?this.isNewForm=!0:this.getUserRole(this.$route.params.id)},mounted:function(){this.fetchItems()},watch:{}}),c=i,l=(r("84aa"),r("2877")),u=Object(l["a"])(c,a,s,!1,null,null,null);t["default"]=u.exports},2909:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var a=r("6b75");function s(e){if(Array.isArray(e))return Object(a["a"])(e)}r("a4d3"),r("e01a"),r("d3b7"),r("d28b"),r("3ca3"),r("ddb0"),r("a630");function o(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}var n=r("06c5");function i(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(e){return s(e)||o(e)||Object(n["a"])(e)||i()}},"84aa":function(e,t,r){"use strict";r("ce5b")},ce5b:function(e,t,r){}}]);